I"çz<p>Recently, I stumbled on an initiative called ‚ÄúThe Auror Project‚Äù by <a href="https://www.linkedin.com/in/sudarshan-pisupati-607b0ab/">Sudarshan Pisupati</a> which was starting a course called ‚Äú<a href="https://www.linkedin.com/feed/update/urn:li:activity:6919205808157155328/">3 Machine Labs</a>‚Äù. 
‚Äú3 Machine Labs‚Äù is a challenge based learning approach to solidify fundamentals of Active Directory over a series of 9 sessions.</p>

<p>The first session came with a <a href="https://docs.google.com/document/d/1Zk_O_JpFQk5JQRGF9CAC0plml3ua3hCQ5VBDLxE2GQI/edit#heading=h.1vlpfqvcrv4">challenge</a> to automate the process of building an Active Directory Lab with some specifications.</p>

<p>Automation should:</p>
<ul>
  <li>Setup two Virtual Machines; Windows Server &amp; Windows 10</li>
  <li>Install Active Directory Domain Services(ADDS) on the Windows Server and promote the server to Domain controller through a process called DC Promo</li>
  <li>Add Windows 10 machine to Windows Server domain, through a process called Domain join</li>
</ul>

<p>Some specifications for the machines were:
For Windows Server (Domain controller):</p>
<ul>
  <li>Domain name should be ‚Äúauror.local‚Äù</li>
  <li>Has DNS role</li>
  <li>Contains a Domain user called ‚ÄúAdam‚Äù with password ‚ÄúPass@123‚Äù</li>
</ul>

<p>For Windows 10:</p>
<ul>
  <li>Should‚Äôve Google Chrome installed</li>
  <li>User ‚ÄúAdam‚Äù should be configured as a local administrator</li>
  <li>Firewall should be disabled</li>
</ul>

<p>I gave a lot of time to this Task, for which I‚Äôm not sure on how should I feel like.. But..</p>

<p>The pic above shows me running packer builds on my flight to Mumbai xD, hence a fair title for the blog <strong>‚ÄúAutomation on the Fly‚Äù</strong> :D.</p>
<h1 id="mindmap">Mindmap</h1>
<p>This session was already a catch for me. I‚Äôm a huge fan of automation but to my surprise I‚Äôd never given a thought of automating installations of virtual machines and lab environments, even though it was tedious, specially with AD environments. 
Rebuilding an AD Lab manually means setup VMs , DC Promo, user and computer accounts and Domain join again, that too for a clean simplistic AD. 
Sudarshan spoke about Clicks vs Time and How this automation needs to minimize clicks to bare minimum.</p>

<p>While snapshots and VM exports may seem like an easy way out for standalone machines, things get complicated in an Active Directory environment. 
Snapshots break for AD because of ‚ÄúTime‚Äù.</p>
<ul>
  <li>Domain Members (includes computers) have a maximum password age of 30 days. If reverted, password in AD and the computer may not match</li>
  <li>In AD, authentication works using Kerberos and Kerberos authentication uses time stamps as part of its protocol. Out of sync timestamps can result in missing tickets and even no authentication at all.</li>
</ul>

<h2 id="how-to-automate">How to automate?</h2>
<p>Question arises on how we can automate the whole process of VM installation from ISO files and configure those VMs according to our need.
There are a lot of alternatives and I‚Äôve documented the automation using <strong>Packer</strong> and <strong>Vagrant</strong> with VirtualBox as my preferred choice of hypervisor, needless to say configuration files can be easily modified to any hypervisor of your choice.</p>

<p><a href="https://www.packer.io/intro">Packer</a> is the first step which will create a base VM from the ISO.
<a href="https://www.vagrantup.com/intro">Vagrant</a> will then further on build the whole virtual machine environment from the output of Packer by cloning and modifying/managing it.</p>
<h2 id="what-youll-need">What you‚Äôll need?</h2>
<ul>
  <li><a href="https://www.packer.io/downloads">Packer</a> or <code class="language-plaintext highlighter-rouge">choco install packer -y</code> using <a href="https://adamrushuk.github.io/cheatsheets/chocolatey/">Chocolatey</a></li>
  <li><a href="https://www.vagrantup.com/downloads">Vagrant</a></li>
  <li><a href="https://software-static.download.prss.microsoft.com/pr/download/17763.737.190906-2324.rs5_release_svc_refresh_SERVER_EVAL_x64FRE_en-us_1.iso">ISO file for Windows Server 2019</a></li>
  <li><a href="https://software-static.download.prss.microsoft.com/sg/download/444969d5-f34g-4e03-ac9d-1f9786c69161/19044.1288.211006-0501.21h2_release_svc_refresh_CLIENTENTERPRISEEVAL_OEMRET_x64FRE_en-us.iso">ISO file for Windows 10</a></li>
  <li><a href="https://github.com/0xCaretaker/Auror-Project">Cloned Github repo</a></li>
</ul>

<blockquote>
  <p>Note: You can even download the latest Windows Server 2019 and Windows 10 image from <a href="https://www.microsoft.com/en-us/evalcenter/download-windows-server-2019">here</a> and <a href="https://www.microsoft.com/en-us/evalcenter/download-windows-10-enterprise">here</a> but remember to modify <code class="language-plaintext highlighter-rouge">iso_url</code> and <code class="language-plaintext highlighter-rouge">iso_checksum</code> variable in json files for Packer accordingly.</p>
</blockquote>

<h2 id="packer">Packer</h2>
<p>Packer needs a JSON file or HCL file as a template to configure the build here I‚Äôve the files named <code class="language-plaintext highlighter-rouge">server-2019.json</code> and <code class="language-plaintext highlighter-rouge">win10.json</code> for both the machines.</p>

<p>This is the hierarchy for all the packer files needed for server-2019 and is similar for Windows 10 machine:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>server-2019/
‚îú‚îÄ‚îÄ files
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ autounattend.xml
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ scripts
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ fixnetwork.ps1
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ sysprep.bat
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ winrmConfig.bat
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ unattend.xml
‚îú‚îÄ‚îÄ server-2019.json
‚îî‚îÄ‚îÄ server-2019-vagrantfile.template
</pre></td></tr></tbody></table></code></pre></div></div>

<p>I‚Äôve used JSON template files which contains all the necessary configuration like Type of installation(ISO here), Disk size, No. of CPUs, Memory size, OS type, ISO url/path, communicator type for vagrant(WinRM here) with it‚Äôs credentials, files which need to be mounted for use and finally the post processors(vagrant) for it‚Äôs output.</p>

<h3 id="external-scripts-in-packer">External scripts in packer</h3>
<p>As you can see there are 3 common external scripts I have used with packer in <a href="https://github.com/0xCaretaker/Auror-Project">my git repo</a>, namely <code class="language-plaintext highlighter-rouge">fixnetwork.ps1</code>, <code class="language-plaintext highlighter-rouge">winrmConfig.bat</code> and <code class="language-plaintext highlighter-rouge">sysprep.bat</code>.</p>

<ul>
  <li>
    <p>winrmConfig.bat
Communicators are used by Packer to upload files, execute scripts, etc. with the machine being created. <code class="language-plaintext highlighter-rouge">winrmConfig.bat</code> is a pre-run script that configures and enables WinRM on the guest machine. 
All the configuration and code for the script has been given in Packer docs:<a href="https://www.packer.io/docs/communicators/winrm">www.packer.io/docs/communicators/winrm</a></p>
  </li>
  <li>
    <p>fixnetwork.ps1
If you try to run the above <code class="language-plaintext highlighter-rouge">winrmConfig.bat</code> in windows10, it‚Äôll not work because on a Server OS, like Windows Server 2019, the firewall rule for Public networks allows on remote connections from other devices on the same network. On a client OS, like Windows 10, you will receive an error stating that you are a public network.
Here‚Äôs an article which goes in detail for WinRM configuration and how networks should be managed: <a href="https://adamtheautomator.com/enable-psremoting/">adamtheautomator.com/enable-psremoting</a></p>
  </li>
  <li>
    <p>sysprep.bat
Before you can deploy a Windows image to new PCs, you have to first generalize the image. Generalizing the image removes computer-specific information such as installed drivers and the computer security identifier (SID). 
The <code class="language-plaintext highlighter-rouge">sysprep /generalize</code> command removes unique information from your Windows installation so that you can safely reuse that image on a different computer. The next time that you boot the Windows image, the specialize configuration pass runs.
I‚Äôve used <code class="language-plaintext highlighter-rouge">unattend.xml</code> answer file with sysprep to generalize my image.</p>
    <blockquote>
      <p>You can see the GUI execution of SysPrep <a href="https://mivilisnet.wordpress.com/2017/06/29/changing-sid-of-cloned-vms/">here</a> to get more context.</p>
    </blockquote>
  </li>
</ul>

<p>References: <a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11#generalize-using-unattend">SysPrep using unattend</a>, <a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep-command-line-options?view=windows-11">SysPrep Command line options</a></p>

<p>There are two more scripts: <code class="language-plaintext highlighter-rouge">cleanup.ps1</code> and <code class="language-plaintext highlighter-rouge">setup.ps1</code> used with Windows 10 machine to fiddle with thing like: Windows Updates, Temporary files, password expiration for administrator, Disabling sleep, hibernation and configuring Powershell prompt to show time.</p>
<h2 id="vagrant">Vagrant</h2>
<p>Vagrant uses <code class="language-plaintext highlighter-rouge">Vagrantfile</code> containing the configuration to make the environment for the virtual machine.
Here‚Äôs the hierarchy of the vagrant files needed for building the whole lab from the output of Packer which is <code class="language-plaintext highlighter-rouge">server-2019.box</code> and <code class="language-plaintext highlighter-rouge">win10.box</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>Vagrant/
‚îú‚îÄ‚îÄ files
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ add-adam.ps1
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ add-localadmin.ps1
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ install-active-directory.ps1
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ install-chrome.ps1
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ join-domain.ps1
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ set-timezone.ps1
‚îú‚îÄ‚îÄ server-2019.box
‚îú‚îÄ‚îÄ Vagrantfile
‚îî‚îÄ‚îÄ win10.box
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Vagrantfile</code> provides hostname for the machines, their network configuration and uses the WinRM credentials(configured in Packer) to communicate with the guest and run scripts. It even handles VirtualBox configuration for the name, memory(including video memory), guest additions like shared clipboard etc.
    <blockquote>
      <p>Note: Be careful on the network adapter configuration, I‚Äôve kept 10.1.1.0/24 as subnet, which shouldn‚Äôt collide with the other having 10.0.2.0/24
(I was trying to keep the original network given to us: 10.0.0.0/24, where DC01 had the IP 10.0.0.9. But, If I mention the gateway as 10.0.0.0, it would collide with the first adapter, by giving the second adapter the subnet of 10.0.0.0/8)</p>
    </blockquote>
  </li>
</ul>

<p>Scripts used:
For DC01:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">set-timezone.ps1</code> - Sets timezone for DC01</li>
  <li><code class="language-plaintext highlighter-rouge">install-active-directory.ps1</code> - Install ADDS and perform DCPromo, create a new forest which contains a domain named <code class="language-plaintext highlighter-rouge">auror.local</code></li>
  <li><code class="language-plaintext highlighter-rouge">add-adam.ps1</code> - Adds a user named <code class="language-plaintext highlighter-rouge">Adam</code>
For PC01:</li>
  <li><code class="language-plaintext highlighter-rouge">install-chrome.ps1</code> - Installs chrome, disables firewall and enables RDP for PC01</li>
  <li><code class="language-plaintext highlighter-rouge">join-domain.ps1</code> - Performs Domain Join process using <code class="language-plaintext highlighter-rouge">Add-Computer</code>, by first setting the DNS as DC01</li>
  <li><code class="language-plaintext highlighter-rouge">add-localadmin.ps1</code> - Sets <code class="language-plaintext highlighter-rouge">Adam</code> as local administrator for PC01, Runs windows update and disables windows defender automatic submissions</li>
</ul>

<h1 id="what-a-waste-of-time">What a waste of time‚Ä¶</h1>
<p>Since, I‚Äôd no clue what Packer and Vagrant is before this project, this section will go in an in-depth explanation on how everything works using Packer and Vagrant.
You don‚Äôt necessarily have to read this and can go to <a href="https://0xcaretaker.github.io/Automation on the Fly - The Auror Project">TL;DR Build the lab?</a>
First, Packer will be used to build the base VM from the ISOs.</p>

<h2 id="explaining-packer-files">Explaining Packer files</h2>
<p>I discussed about the template JSON file, but what about others?</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">server-2019-vagrantfile.template</code> is used in the <code class="language-plaintext highlighter-rouge">post_processors</code> section as this template file will be needed to output the build in <code class="language-plaintext highlighter-rouge">.box</code> format for Vagrant.</li>
  <li><code class="language-plaintext highlighter-rouge">autounattend.xml</code> is the core answer file for automating the whole windows installation process</li>
  <li><code class="language-plaintext highlighter-rouge">unattend.xml</code> is another answer file which is used to modify windows settings after the first user is created and assigned a default language(We‚Äôll need that with SysPrep)</li>
  <li>Scripts folder contains various scripts already discussed</li>
</ul>

<h3 id="what-is-autounattendxml">What is autounattend.xml?</h3>
<p>The most important file for Packer is <code class="language-plaintext highlighter-rouge">autounattend.xml</code>, it acts as an answer file to Windows Setup installation since all the UI pages needs to be automated. Unattended installation settings can be applied in one or more configuration passes.</p>

<p>But <strong>What are Windows setup configuration passes?</strong></p>
<blockquote>
  <p>Windows Setup Configuration Passes are used to specify different phases of Windows Setup. 
Source: <a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/windows-setup-configuration-passes?view=windows-11">Windows-Setup-Configuration-Passes</a></p>
</blockquote>

<p>The following diagram shows the relationship between the configuration passes relative to the different deployment tools.</p>

<p>![/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-2.png]</p>

<p>Not all configuration passes run in a particular installation of Windows. Some configuration passes, such as <code class="language-plaintext highlighter-rouge">auditSystem</code> and <code class="language-plaintext highlighter-rouge">auditUser</code>, run only if you boot the computer to audit mode. 
Most Windows Setup <code class="language-plaintext highlighter-rouge">unattend</code> settings can be added to either the <code class="language-plaintext highlighter-rouge">specialize</code> or the <code class="language-plaintext highlighter-rouge">oobeSystem</code> configuration pass. The other configuration passes can also be useful in certain situations.</p>

<h4 id="windowspe-configuration-pass">windowsPE Configuration pass</h4>
<p>The windowsPE configuration pass is used to configure settings specific to Windows Preinstallation Environment (Windows PE) in addition to settings that apply to installation.
This configuration pass runs when booting the Windows Setup media.</p>

<p>For more info: <a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/windowspe?view=windows-11">Microsoft-WindowsPE</a></p>

<p>As already stated, windowsPE configures settings related to the installation environment and then the setup as well. So, it usually has 2 components <code class="language-plaintext highlighter-rouge">Microsoft-Windows-International-Core-WinPE</code> and <code class="language-plaintext highlighter-rouge">Microsoft-Windows-Setup</code>.</p>

<h5 id="component-microsoft-windows-international-core-winpe">Component <code class="language-plaintext highlighter-rouge">Microsoft-Windows-International-Core-WinPE</code></h5>
<p>It specifies the default language, locale, and other international settings to use during Windows Setup or Windows Deployment Services installations.</p>

<p>So, The first screen, which is the language selection screen is now automated.<br />
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-3.png" alt="Pasted image 20220524165329.png" /></p>

<p>The code snippet looks something like this:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>        <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"Microsoft-Windows-International-Core-WinPE"</span> <span class="na">processorArchitecture=</span><span class="s">"amd64"</span> <span class="na">publicKeyToken=</span><span class="s">"31bf3856ad364e35"</span> <span class="na">language=</span><span class="s">"neutral"</span> <span class="na">versionScope=</span><span class="s">"nonSxS"</span> <span class="na">xmlns:wcm=</span><span class="s">"http://schemas.microsoft.com/WMIConfig/2002/State"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;SetupUILanguage&gt;</span>
                <span class="nt">&lt;UILanguage&gt;</span>en-US<span class="nt">&lt;/UILanguage&gt;</span>
            <span class="nt">&lt;/SetupUILanguage&gt;</span>
            <span class="nt">&lt;InputLocale&gt;</span>en-US<span class="nt">&lt;/InputLocale&gt;</span>
            <span class="nt">&lt;SystemLocale&gt;</span>en-US<span class="nt">&lt;/SystemLocale&gt;</span>
            <span class="nt">&lt;UILanguage&gt;</span>en-US<span class="nt">&lt;/UILanguage&gt;</span>
            <span class="nt">&lt;UILanguageFallback&gt;</span>en-US<span class="nt">&lt;/UILanguageFallback&gt;</span>
            <span class="nt">&lt;UserLocale&gt;</span>en-US<span class="nt">&lt;/UserLocale&gt;</span>
        <span class="nt">&lt;/component&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 id="component-microsoft-windows-setup">Component <code class="language-plaintext highlighter-rouge">Microsoft-Windows-Setup</code></h5>
<p>This component contains settings that enable you to select the Windows image that you install, configure the disk that you install Windows to, and configure the Windows PE operating system.</p>

<ol>
  <li>Imageinstall
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>         <span class="nt">&lt;ImageInstall&gt;</span>
             <span class="nt">&lt;OSImage&gt;</span>
                 <span class="nt">&lt;InstallFrom&gt;</span>
                     <span class="nt">&lt;MetaData</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                         <span class="nt">&lt;Key&gt;</span>/IMAGE/NAME<span class="nt">&lt;/Key&gt;</span>
                         <span class="nt">&lt;Value&gt;</span>Windows Server 2019 SERVERSTANDARD<span class="nt">&lt;/Value&gt;</span>
                     <span class="nt">&lt;/MetaData&gt;</span>
                 <span class="nt">&lt;/InstallFrom&gt;</span>
                 <span class="nt">&lt;InstallTo&gt;</span>
                     <span class="nt">&lt;DiskID&gt;</span>0<span class="nt">&lt;/DiskID&gt;</span>
                     <span class="nt">&lt;PartitionID&gt;</span>2<span class="nt">&lt;/PartitionID&gt;</span>
                 <span class="nt">&lt;/InstallTo&gt;</span>
             <span class="nt">&lt;/OSImage&gt;</span>
         <span class="nt">&lt;/ImageInstall&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p><img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-4.png" alt="Pasted image 20220524165828.png" /></p>
  </li>
  <li>Now we‚Äôre greeted with EULA agreement message:
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-5.png" alt="Pasted image 20220524165919.png" />
and that is handled by:
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>         <span class="nt">&lt;UserData&gt;</span>
             <span class="nt">&lt;AcceptEula&gt;</span>true<span class="nt">&lt;/AcceptEula&gt;</span>
             <span class="nt">&lt;FullName&gt;</span>Packer<span class="nt">&lt;/FullName&gt;</span>
             <span class="nt">&lt;Organization&gt;</span>Packer<span class="nt">&lt;/Organization&gt;</span>
         <span class="nt">&lt;/UserData&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Disk configuration:
This configuration creates 2 partitions:
    <ul>
      <li>boot partition of 350MB in size</li>
      <li>Rest size extended for C Drive
        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre>       <span class="nt">&lt;DiskConfiguration&gt;</span>
           <span class="nt">&lt;Disk</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;CreatePartitions&gt;</span>
                   <span class="nt">&lt;CreatePartition</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                       <span class="nt">&lt;Type&gt;</span>Primary<span class="nt">&lt;/Type&gt;</span>
                       <span class="nt">&lt;Order&gt;</span>1<span class="nt">&lt;/Order&gt;</span>
                       <span class="nt">&lt;Size&gt;</span>350<span class="nt">&lt;/Size&gt;</span>
                   <span class="nt">&lt;/CreatePartition&gt;</span>
                   <span class="nt">&lt;CreatePartition</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                       <span class="nt">&lt;Order&gt;</span>2<span class="nt">&lt;/Order&gt;</span>
                       <span class="nt">&lt;Type&gt;</span>Primary<span class="nt">&lt;/Type&gt;</span>
                       <span class="nt">&lt;Extend&gt;</span>true<span class="nt">&lt;/Extend&gt;</span>
                   <span class="nt">&lt;/CreatePartition&gt;</span>
               <span class="nt">&lt;/CreatePartitions&gt;</span>
               <span class="nt">&lt;ModifyPartitions&gt;</span>
                   <span class="nt">&lt;ModifyPartition</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                       <span class="nt">&lt;Active&gt;</span>true<span class="nt">&lt;/Active&gt;</span>
                       <span class="nt">&lt;Format&gt;</span>NTFS<span class="nt">&lt;/Format&gt;</span>
                       <span class="nt">&lt;Label&gt;</span>boot<span class="nt">&lt;/Label&gt;</span>
                       <span class="nt">&lt;Order&gt;</span>1<span class="nt">&lt;/Order&gt;</span>
                       <span class="nt">&lt;PartitionID&gt;</span>1<span class="nt">&lt;/PartitionID&gt;</span>
                   <span class="nt">&lt;/ModifyPartition&gt;</span>
                   <span class="nt">&lt;ModifyPartition</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                       <span class="nt">&lt;Format&gt;</span>NTFS<span class="nt">&lt;/Format&gt;</span>
                       <span class="nt">&lt;Label&gt;</span>Local Disk<span class="nt">&lt;/Label&gt;</span>
                       <span class="nt">&lt;Letter&gt;</span>C<span class="nt">&lt;/Letter&gt;</span>
                       <span class="nt">&lt;Order&gt;</span>2<span class="nt">&lt;/Order&gt;</span>
                       <span class="nt">&lt;PartitionID&gt;</span>2<span class="nt">&lt;/PartitionID&gt;</span>
                   <span class="nt">&lt;/ModifyPartition&gt;</span>
               <span class="nt">&lt;/ModifyPartitions&gt;</span>
               <span class="nt">&lt;DiskID&gt;</span>0<span class="nt">&lt;/DiskID&gt;</span>
               <span class="nt">&lt;WillWipeDisk&gt;</span>true<span class="nt">&lt;/WillWipeDisk&gt;</span>
           <span class="nt">&lt;/Disk&gt;</span>
       <span class="nt">&lt;/DiskConfiguration&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>        </div>
        <p><img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-6.png" alt="Pasted image 20220524170143.png" /></p>
      </li>
    </ul>
  </li>
</ol>

<h4 id="offlineservicing-configuration-pass">offlineServicing Configuration pass</h4>

<p><code class="language-plaintext highlighter-rouge">offlineServicing</code> configuration pass to apply unattended Setup settings to an offline Microsoft Windows image. During this configuration pass, you can add language packs, update package, device drivers, or other packages to the offline image.
The Microsoft-Windows-LUA-Settings component includes settings related to the Windows User Account Controls (UAC), formerly known as Limited User Account (LUA).</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>    <span class="nt">&lt;settings</span> <span class="na">pass=</span><span class="s">"offlineServicing"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"Microsoft-Windows-LUA-Settings"</span> <span class="na">processorArchitecture=</span><span class="s">"amd64"</span> <span class="na">publicKeyToken=</span><span class="s">"31bf3856ad364e35"</span> <span class="na">language=</span><span class="s">"neutral"</span> <span class="na">versionScope=</span><span class="s">"nonSxS"</span> <span class="na">xmlns:wcm=</span><span class="s">"http://schemas.microsoft.com/WMIConfig/2002/State"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;EnableLUA&gt;</span>false<span class="nt">&lt;/EnableLUA&gt;</span>
        <span class="nt">&lt;/component&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>EnableLUA specifies whether the windows User Account Controls (UAC) should notify the user when programs try to make changes to the computer.</p>

<p>We set that to false, so that UAC prompts aren‚Äôt popped up.</p>
<h4 id="specialize-configuration-pass">specialize Configuration pass</h4>
<p>During the <code class="language-plaintext highlighter-rouge">specialize</code> configuration pass of Windows Setup, computer-specific information for the image is applied.</p>

<p>For example you can:</p>
<ul>
  <li>configure network settings, timezone settings, and domain information.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;settings</span> <span class="na">pass=</span><span class="s">"specialize"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"Microsoft-Windows-Shell-Setup"</span> <span class="na">processorArchitecture=</span><span class="s">"amd64"</span> <span class="na">publicKeyToken=</span><span class="s">"31bf3856ad364e35"</span> <span class="na">language=</span><span class="s">"neutral"</span> <span class="na">versionScope=</span><span class="s">"nonSxS"</span> <span class="na">xmlns:wcm=</span><span class="s">"http://schemas.microsoft.com/WMIConfig/2002/State"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;OEMInformation&gt;</span>
              <span class="nt">&lt;HelpCustomized&gt;</span>false<span class="nt">&lt;/HelpCustomized&gt;</span>
          <span class="nt">&lt;/OEMInformation&gt;</span>
          <span class="nt">&lt;ComputerName&gt;</span>Server-2019<span class="nt">&lt;/ComputerName&gt;</span>
          <span class="nt">&lt;TimeZone&gt;</span>India Standard Time<span class="nt">&lt;/TimeZone&gt;</span>
          <span class="nt">&lt;RegisteredOwner/&gt;</span>
      <span class="nt">&lt;/component&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Computer specific configuration like not opening Server Manager whenever a user logs on
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>      <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"Microsoft-Windows-ServerManager-SvrMgrNc"</span> <span class="na">processorArchitecture=</span><span class="s">"amd64"</span> <span class="na">publicKeyToken=</span><span class="s">"31bf3856ad364e35"</span> <span class="na">language=</span><span class="s">"neutral"</span> <span class="na">versionScope=</span><span class="s">"nonSxS"</span> <span class="na">xmlns:wcm=</span><span class="s">"http://schemas.microsoft.com/WMIConfig/2002/State"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;DoNotOpenServerManagerAtLogon&gt;</span>true<span class="nt">&lt;/DoNotOpenServerManagerAtLogon&gt;</span>
      <span class="nt">&lt;/component&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>and Setting Global execution policy of 64/32-Bit to be Remotely signed using <code class="language-plaintext highlighter-rouge">RunSynchronousCommand</code>
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>      <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"Microsoft-Windows-Deployment"</span> <span class="na">processorArchitecture=</span><span class="s">"amd64"</span> <span class="na">publicKeyToken=</span><span class="s">"31bf3856ad364e35"</span> <span class="na">language=</span><span class="s">"neutral"</span> <span class="na">versionScope=</span><span class="s">"nonSxS"</span> <span class="na">xmlns:wcm=</span><span class="s">"http://schemas.microsoft.com/WMIConfig/2002/State"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;RunSynchronous&gt;</span>
              <span class="nt">&lt;RunSynchronousCommand</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                  <span class="nt">&lt;Order&gt;</span>1<span class="nt">&lt;/Order&gt;</span>
                  <span class="nt">&lt;Description&gt;</span>Set Execution Policy 64 Bit<span class="nt">&lt;/Description&gt;</span>
                  <span class="nt">&lt;Path&gt;</span>cmd.exe /c powershell -Command "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force"<span class="nt">&lt;/Path&gt;</span>
              <span class="nt">&lt;/RunSynchronousCommand&gt;</span>
              <span class="nt">&lt;RunSynchronousCommand</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                  <span class="nt">&lt;Order&gt;</span>2<span class="nt">&lt;/Order&gt;</span>
                  <span class="nt">&lt;Description&gt;</span>Set Execution Policy 32 Bit<span class="nt">&lt;/Description&gt;</span>
                  <span class="nt">&lt;Path&gt;</span>cmd.exe /c powershell -Command "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force"<span class="nt">&lt;/Path&gt;</span>
              <span class="nt">&lt;/RunSynchronousCommand&gt;</span>
          <span class="nt">&lt;/RunSynchronous&gt;</span>
      <span class="nt">&lt;/component&gt;</span>
  <span class="nt">&lt;/settings&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h4 id="oobsystem-configuration-pass">oobSystem Configuration pass</h4>
<p>The <code class="language-plaintext highlighter-rouge">oobeSystem</code> configuration pass, also known as Windows Welcome, can be used to preconfigure user interface pages for an end user.</p>

<p>Like this built-in administrator account can be automated by <code class="language-plaintext highlighter-rouge">oobsystem</code> as:
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-7.png" alt="Pasted image 20220524173008.png" /></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>            <span class="nt">&lt;UserAccounts&gt;</span>
                <span class="nt">&lt;AdministratorPassword&gt;</span>
                    <span class="nt">&lt;Value&gt;</span>vagrant<span class="nt">&lt;/Value&gt;</span>
                    <span class="nt">&lt;PlainText&gt;</span>true<span class="nt">&lt;/PlainText&gt;</span>
                <span class="nt">&lt;/AdministratorPassword&gt;</span>
                <span class="nt">&lt;LocalAccounts&gt;</span>
                    <span class="nt">&lt;LocalAccount</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;Password&gt;</span>
                            <span class="nt">&lt;Value&gt;</span>vagrant<span class="nt">&lt;/Value&gt;</span>
                            <span class="nt">&lt;PlainText&gt;</span>true<span class="nt">&lt;/PlainText&gt;</span>
                        <span class="nt">&lt;/Password&gt;</span>
                        <span class="nt">&lt;Group&gt;</span>administrators<span class="nt">&lt;/Group&gt;</span>
                        <span class="nt">&lt;DisplayName&gt;</span>Vagrant<span class="nt">&lt;/DisplayName&gt;</span>
                        <span class="nt">&lt;Name&gt;</span>vagrant<span class="nt">&lt;/Name&gt;</span>
                        <span class="nt">&lt;Description&gt;</span>Vagrant User<span class="nt">&lt;/Description&gt;</span>
                    <span class="nt">&lt;/LocalAccount&gt;</span>
                <span class="nt">&lt;/LocalAccounts&gt;</span>
            <span class="nt">&lt;/UserAccounts&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Then using these credentials we can even configure the user-specific configurations as:</p>
<ul>
  <li>Autologon
Specifies credentials for an account that is used to automatically log on to the computer.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>          <span class="nt">&lt;AutoLogon&gt;</span>
              <span class="nt">&lt;Password&gt;</span>
                  <span class="nt">&lt;Value&gt;</span>vagrant<span class="nt">&lt;/Value&gt;</span>
                  <span class="nt">&lt;PlainText&gt;</span>true<span class="nt">&lt;/PlainText&gt;</span>
              <span class="nt">&lt;/Password&gt;</span>
              <span class="nt">&lt;Enabled&gt;</span>true<span class="nt">&lt;/Enabled&gt;</span>
              <span class="nt">&lt;Username&gt;</span>vagrant<span class="nt">&lt;/Username&gt;</span>
          <span class="nt">&lt;/AutoLogon&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>FirstLogonCommands
Specifies commands to run the first time that an end user logs on to the computer.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>          <span class="nt">&lt;FirstLogonCommands&gt;</span>
              <span class="nt">&lt;SynchronousCommand</span> <span class="na">wcm:action=</span><span class="s">"add"</span><span class="nt">&gt;</span>
                  <span class="nt">&lt;CommandLine&gt;</span>cmd.exe /c powershell -Command "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force"<span class="nt">&lt;/CommandLine&gt;</span>
                  <span class="nt">&lt;Description&gt;</span>Set Execution Policy 64 Bit<span class="nt">&lt;/Description&gt;</span>
                  <span class="nt">&lt;Order&gt;</span>1<span class="nt">&lt;/Order&gt;</span>
                  <span class="nt">&lt;RequiresUserInput&gt;</span>true<span class="nt">&lt;/RequiresUserInput&gt;</span>
              <span class="nt">&lt;/SynchronousCommand&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>OOBE 
OOBE specifies the behavior of some of the Windows Out of Box Experience (OOBE) screens.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>          <span class="nt">&lt;OOBE&gt;</span>
              <span class="nt">&lt;HideEULAPage&gt;</span>true<span class="nt">&lt;/HideEULAPage&gt;</span>
              <span class="nt">&lt;HideLocalAccountScreen&gt;</span>true<span class="nt">&lt;/HideLocalAccountScreen&gt;</span>
              <span class="nt">&lt;HideOEMRegistrationScreen&gt;</span>true<span class="nt">&lt;/HideOEMRegistrationScreen&gt;</span>
              <span class="nt">&lt;HideOnlineAccountScreens&gt;</span>true<span class="nt">&lt;/HideOnlineAccountScreens&gt;</span>
              <span class="nt">&lt;HideWirelessSetupInOOBE&gt;</span>true<span class="nt">&lt;/HideWirelessSetupInOOBE&gt;</span>
              <span class="nt">&lt;NetworkLocation&gt;</span>Home<span class="nt">&lt;/NetworkLocation&gt;</span>
              <span class="nt">&lt;ProtectYourPC&gt;</span>1<span class="nt">&lt;/ProtectYourPC&gt;</span>
          <span class="nt">&lt;/OOBE&gt;</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h2 id="click-click--windows-adk">Click, Click .. Windows ADK</h2>
<p>So, I spent so long in understanding what all the components and functions do, that I accidently stumbled onto Windows ADK and felt like a complete loser.</p>

<p>Now, talking about how you don‚Äôt have to write answer xml files yourselves, rather generate it using Windows Assessment and Deployment Kit(ADK).</p>

<p>Install <a href="https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install">Windows ADK</a> and..</p>
<ol>
  <li>Click on File -&gt; Create answer file -&gt; Click yes, to open Windows image
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-8.png" alt="Pasted image 20220526151518.png" /></li>
  <li>
    <p>Mount the ISO -&gt; copy all the files to a directory, select install.wim
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-9.png" alt="Pasted image 20220526151709.png" />
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-10.png" alt="Pasted image 20220526151745.png" /></p>
  </li>
  <li>Select the OS image name/type</li>
</ol>

<p><img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-11.png" alt="Pasted image 20220526151855.png" /></p>
<ol>
  <li>Create a catalog file</li>
</ol>

<p><img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-12.png" alt="Pasted image 20220526152211.png" />
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-13.png" alt="Pasted image 20220526161438.png" /></p>

<blockquote>
  <p>Note: If you don‚Äôt see the above message and it‚Äôs spitting out errors.</p>
  <ol>
    <li>Try installing a different version of ADK. (Windows 10, version 1809 worked for me)</li>
    <li>Even after that if you‚Äôre getting errors like: <code class="language-plaintext highlighter-rouge">This application requires version 6.3.9600.16384 of the Windows ADK. Install this version to correct the problem</code>. Try copying that <code class="language-plaintext highlighter-rouge">install.wim</code> file to another location.</li>
  </ol>
</blockquote>

<p>Now, let‚Äôs suppose, I want to add some configuration related to Internet Explorer. I can just Right-Click and add to specific pass.
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-14.png" alt="Pasted image 20220526163637.png" /></p>

<p>Each component has a lot of properties which you can configure, like IE has:
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-15.png" alt="Pasted image 20220526164430.png" />
I‚Äôve made some changes so that:</p>
<ul>
  <li>Popups are blocked</li>
  <li>DevTools is disabled</li>
  <li>No frustrating first run wizard</li>
  <li>Homepage is Google and I‚Äôm not slammed with some MSN news</li>
  <li>A Custom User-Agent</li>
</ul>

<p>Do all you want and then export the answer file as <code class="language-plaintext highlighter-rouge">autounattend.xml</code> ;)</p>

<h1 id="tldr-build-the-lab">TL;DR Build the lab?</h1>
<p>I‚Äôve given the installation steps in my <a href="https://github.com/0xCaretaker/Auror-Project">git repo</a>, I‚Äôll show what really happens when you run those commands.</p>

<ol>
  <li>Download the ISO files in the main(Auror-Project) directory</li>
  <li>Build ISO using packer with <code class="language-plaintext highlighter-rouge">packer build server-2019.json</code> &amp; <code class="language-plaintext highlighter-rouge">packer build win10.json</code> 
or 
even better you can run <code class="language-plaintext highlighter-rouge">.\packer-build.bat</code> to run both the packer builds at the same time.(On windows ofc, for Linux you can use <code class="language-plaintext highlighter-rouge">nohup &lt;cmd&gt; &amp;</code>)
which contains:
    <div class="language-batch highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre> <span class="nb">start</span> <span class="nb">cmd</span> <span class="na">/K </span><span class="s2">"cd Packer\server-2019 &amp;&amp; packer build server-2019.json"</span>
 <span class="nb">start</span> <span class="nb">cmd</span> <span class="na">/K </span><span class="s2">"cd Packer\win10 &amp;&amp; packer build win10.json"</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>

    <p>Output:
Build will take sometime and should look like this:
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-16.png" alt="Pasted image 20220625172205.png" />
My build finished in ~20 mins.
<img src="/assets/img/Posts/auror-task1-automation-on-the-fly/auror-task1-17.png" alt="Pasted image 20220625200602.png" /></p>
  </li>
  <li>Now, We‚Äôve to configure the built base images with vagrant to build our environment.
    <div class="language-batch highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> <span class="kd">Vagrant</span> <span class="o">&amp;&amp;</span> <span class="kd">vagrant</span> <span class="kd">up</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>My Vagrant took 38 minutes to set up the environment. Taking it as ~40 mins.</p>
  </li>
</ol>

<p>There it is.. Complete lab from scratch in your fingertips within 60 mins.</p>

<h1 id="under-the-hood-build">Under the hood (Build)</h1>
<h3 id="building-server-2019-with-packer">Building Server-2019 with Packer</h3>
<ol>
  <li>Retrieves ISO and tries to fetch it from the given location</li>
  <li>Creates a floppy disk, copies all the floppy files</li>
  <li>Creates a VM with the given size</li>
  <li>Mounts ISO, mounts and attaches floppy disk</li>
  <li>Creates forwarded port mapping for communicators like SSH and WinRM with the given credentials</li>
  <li>Executes VBoxManage commands for Memory and CPU config</li>
  <li>Starts VM, waits for boot and tries to connect to the installation using communicator (WinRM)</li>
  <li>Installation using the autounattend.xml carries on</li>
  <li>After the installation completes, shutdown command is triggered, which initializes SysPrep</li>
  <li>Deletes forwarded mapping for communicators</li>
  <li>Exports VM in .ovf format and deletes VM</li>
  <li>Runs Post processor vagrant which takes the .ovf artifact and outputs a Vagrant .box using the template provided</li>
</ol>

<div class="language-batch highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
</pre></td><td class="rouge-code"><pre><span class="s1">'Command: packer build server-2019.json'</span>
<span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">output</span> <span class="kd">will</span> <span class="kd">be</span> <span class="k">in</span> <span class="kd">this</span> <span class="nb">color</span>.

<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Retrieving</span> <span class="kd">ISO</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Trying</span> ../../WinSrv_2019_17763.737.190906<span class="o">-</span><span class="m">2324</span>.rs5_release_svc_refresh_SERVER_EVAL_x64FRE_en<span class="na">-us</span>_1.iso
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Trying</span> ../../WinSrv_2019_17763.737.190906<span class="o">-</span><span class="m">2324</span>.rs5_release_svc_refresh_SERVER_EVAL_x64FRE_en<span class="na">-us</span>_1.iso<span class="o">?</span><span class="kd">checksum</span><span class="o">=</span><span class="kd">sha256</span><span class="err">%</span><span class="m">3</span><span class="kd">A549bca46c055157291be6c22a3aaaed8330e78ef4382c99ee82c896426a1cee1</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: ../../WinSrv_2019_17763.737.190906<span class="o">-</span><span class="m">2324</span>.rs5_release_svc_refresh_SERVER_EVAL_x64FRE_en<span class="na">-us</span>_1.iso<span class="o">?</span><span class="kd">checksum</span><span class="o">=</span><span class="kd">sha256</span><span class="err">%</span><span class="m">3</span><span class="kd">A549bca46c055157291be6c22a3aaaed8330e78ef4382c99ee82c896426a1cee1</span> <span class="o">=&gt;</span> <span class="kd">D</span>:/Shared/Auror<span class="na">-Project/WinSrv</span>_2019_17763.737.190906<span class="o">-</span><span class="m">2324</span>.rs5_release_svc_refresh_SERVER_EVAL_x64FRE_en<span class="na">-us</span>_1.iso
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">files</span> <span class="kd">flatly</span> <span class="kd">from</span> <span class="kd">floppy_files</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/autounattend</span>.xml
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/unattend</span>.xml
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/scripts/fixnetwork</span>.ps1
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/scripts/sysprep</span>.bat
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/scripts/winrmConfig</span>.bat
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Done</span> <span class="kd">copying</span> <span class="kd">files</span> <span class="kd">from</span> <span class="kd">floppy_files</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Collecting</span> <span class="kd">paths</span> <span class="kd">from</span> <span class="kd">floppy_dirs</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Resulting</span> <span class="kd">paths</span> <span class="kd">from</span> <span class="kd">floppy_dirs</span> : <span class="o">[]</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Done</span> <span class="kd">copying</span> <span class="kd">paths</span> <span class="kd">from</span> <span class="kd">floppy_dirs</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">files</span> <span class="kd">from</span> <span class="kd">floppy_content</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Done</span> <span class="kd">copying</span> <span class="kd">files</span> <span class="kd">from</span> <span class="kd">floppy_content</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">ephemeral</span> <span class="kd">key</span> <span class="kd">pair</span> <span class="k">for</span> <span class="kd">SSH</span> <span class="kd">communicator</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Created</span> <span class="kd">ephemeral</span> <span class="kd">SSH</span> <span class="kd">key</span> <span class="kd">pair</span> <span class="k">for</span> <span class="kd">communicator</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">virtual</span> <span class="kd">machine</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">hard</span> <span class="kd">drive</span> <span class="kd">output</span><span class="na">-virtualbox-iso</span>\Server<span class="o">-</span><span class="m">2019</span>.vdi <span class="kd">with</span> <span class="kd">size</span> <span class="m">40960</span> <span class="kd">MiB</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Mounting</span> <span class="kd">ISOs</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Mounting</span> <span class="kd">boot</span> <span class="kd">ISO</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Deleting</span> <span class="kd">any</span> <span class="kd">current</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Attaching</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">forwarded</span> <span class="kd">port</span> <span class="kd">mapping</span> <span class="k">for</span> <span class="kd">communicator</span> <span class="o">(</span><span class="kd">SSH</span><span class="o">,</span> <span class="kd">WinRM</span><span class="o">,</span> <span class="kd">etc</span><span class="o">)</span> <span class="o">(</span><span class="kd">host</span> <span class="kd">port</span> <span class="m">2305</span><span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span> <span class="kd">custom</span> <span class="kd">VBoxManage</span> <span class="kd">commands</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span>: <span class="kd">modifyvm</span> <span class="kd">Server</span><span class="o">-</span><span class="m">2019</span> <span class="na">--memory </span><span class="m">2048</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span>: <span class="kd">modifyvm</span> <span class="kd">Server</span><span class="o">-</span><span class="m">2019</span> <span class="na">--cpus </span><span class="m">2</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Starting</span> <span class="kd">the</span> <span class="kd">virtual</span> <span class="kd">machine</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">The</span> <span class="kd">VM</span> <span class="kd">will</span> <span class="kd">be</span> <span class="nb">run</span> <span class="kd">headless</span><span class="o">,</span> <span class="kd">without</span> <span class="kd">a</span> <span class="kd">GUI</span>. <span class="kd">If</span> <span class="kd">you</span> <span class="kd">want</span> <span class="kd">to</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">view</span> <span class="kd">the</span> <span class="kd">screen</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">VM</span><span class="o">,</span> <span class="kd">connect</span> <span class="kd">via</span> <span class="kd">VRDP</span> <span class="kd">without</span> <span class="kd">a</span> <span class="kd">password</span> <span class="kd">to</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">rdp</span>://127.0.0.1:5922
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Waiting</span> <span class="m">5</span><span class="kd">m0s</span> <span class="k">for</span> <span class="kd">boot</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Typing</span> <span class="kd">the</span> <span class="kd">boot</span> <span class="kd">command</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Using</span> <span class="kd">WinRM</span> <span class="kd">communicator</span> <span class="kd">to</span> <span class="kd">connect</span>: <span class="m">127</span>.0.0.1
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">WinRM</span> <span class="kd">to</span> <span class="kd">become</span> <span class="kd">available</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">WinRM</span> <span class="kd">connected</span>.
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Connected</span> <span class="kd">to</span> <span class="kd">WinRM</span><span class="err">!</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Uploading</span> <span class="kd">VirtualBox</span> <span class="kd">version</span> <span class="kd">info</span> <span class="o">(</span><span class="m">6</span>.1.34<span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Gracefully</span> <span class="kd">halting</span> <span class="kd">virtual</span> <span class="kd">machine</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>:
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">The</span> <span class="kd">service</span> <span class="kd">name</span> <span class="kd">is</span> <span class="kd">invalid</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">C</span>:\Users\vagrant&gt;net <span class="kd">stop</span> <span class="kd">tiledatamodelsvc</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>:
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">More</span> <span class="nb">help</span> <span class="kd">is</span> <span class="kd">available</span> <span class="kd">by</span> <span class="kd">typing</span> <span class="kd">NET</span> <span class="kd">HELPMSG</span> <span class="m">2185</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>:
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>:
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">C</span>:\Users\vagrant&gt;c:\windows\system32\sysprep\sysprep.exe <span class="na">/generalize /mode</span><span class="nl">:vm</span> <span class="na">/oobe /unattend</span><span class="nl">:a</span>:\unattend.xml
    <span class="kd">virtualbox</span><span class="na">-iso</span>:
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">C</span>:\Users\vagrant&gt;shutdown <span class="na">/s
</span><span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">A</span> <span class="kd">system</span> <span class="nb">shutdown</span> <span class="kd">is</span> <span class="k">in</span> <span class="kd">progress</span>.<span class="o">(</span><span class="m">1115</span><span class="o">)</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Removing</span> <span class="kd">floppy</span> <span class="kd">drive</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Preparing</span> <span class="kd">to</span> <span class="kd">export</span> <span class="kd">machine</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Deleting</span> <span class="kd">forwarded</span> <span class="kd">port</span> <span class="kd">mapping</span> <span class="k">for</span> <span class="kd">the</span> <span class="kd">communicator</span> <span class="o">(</span><span class="kd">SSH</span><span class="o">,</span> <span class="kd">WinRM</span><span class="o">,</span> <span class="kd">etc</span><span class="o">)</span> <span class="o">(</span><span class="kd">host</span> <span class="kd">port</span> <span class="m">2305</span><span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Exporting</span> <span class="kd">virtual</span> <span class="kd">machine</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span>: <span class="kd">export</span> <span class="kd">Server</span><span class="o">-</span><span class="m">2019</span> <span class="na">--output </span><span class="kd">output</span><span class="na">-virtualbox-iso</span>\Server<span class="o">-</span><span class="m">2019</span>.ovf
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Cleaning</span> <span class="kd">up</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Error</span> <span class="kd">unregistering</span> <span class="kd">floppy</span>: <span class="kd">VBoxManage</span> <span class="kd">error</span>: <span class="kd">VBoxManage</span><span class="err">.exe</span>: <span class="kd">error</span>: <span class="kd">Could</span> <span class="ow">not</span> <span class="nb">find</span> <span class="kd">a</span> <span class="kd">controller</span> <span class="kd">named</span> <span class="s1">'Floppy Controller'</span>. <span class="kd">Not</span> <span class="kd">considering</span> <span class="kd">this</span> <span class="kd">a</span> <span class="kd">critical</span> <span class="kd">failure</span><span class="o">;</span> <span class="kd">build</span> <span class="kd">will</span> <span class="kd">continue</span>.
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Deregistering</span> <span class="kd">and</span> <span class="kd">deleting</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Running</span> <span class="kd">post</span><span class="na">-processor</span>: <span class="kd">vagrant</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Creating</span> <span class="kd">a</span> <span class="kd">dummy</span> <span class="kd">Vagrant</span> <span class="kd">box</span> <span class="kd">to</span> <span class="kd">ensure</span> <span class="kd">the</span> <span class="kd">host</span> <span class="kd">system</span> <span class="kd">can</span> <span class="kd">create</span> <span class="kd">one</span> <span class="kd">correctly</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Creating</span> <span class="kd">Vagrant</span> <span class="kd">box</span> <span class="k">for</span> <span class="s1">'virtualbox'</span> <span class="kd">provider</span>
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Copying</span> <span class="kd">from</span> <span class="kd">artifact</span>: <span class="kd">output</span><span class="na">-virtualbox-iso</span>\Server<span class="o">-</span><span class="m">2019</span><span class="na">-disk</span><span class="m">001</span>.vmdk
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Copying</span> <span class="kd">from</span> <span class="kd">artifact</span>: <span class="kd">output</span><span class="na">-virtualbox-iso</span>\Server<span class="o">-</span><span class="m">2019</span>.ovf
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Renaming</span> <span class="kd">the</span> <span class="kd">OVF</span> <span class="kd">to</span> <span class="kd">box</span>.ovf...
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Using</span> <span class="kd">custom</span> <span class="kd">Vagrantfile</span>: <span class="kd">server</span><span class="o">-</span><span class="m">2019</span><span class="na">-vagrantfile</span>.template
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Compressing</span>: <span class="kd">Server</span><span class="o">-</span><span class="m">2019</span><span class="na">-disk</span><span class="m">001</span>.vmdk
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Compressing</span>: <span class="kd">Vagrantfile</span>
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Compressing</span>: <span class="kd">box</span>.ovf
    <span class="kd">virtualbox</span><span class="na">-iso </span><span class="o">(</span><span class="kd">vagrant</span><span class="o">)</span>: <span class="kd">Compressing</span>: <span class="kd">metadata</span>.json
<span class="kd">Build</span> <span class="s1">'virtualbox-iso'</span> <span class="kd">finished</span> <span class="kd">after</span> <span class="m">13</span> <span class="kd">minutes</span> <span class="m">52</span> <span class="kd">seconds</span>.

<span class="o">==&gt;</span> <span class="kd">Wait</span> <span class="kd">completed</span> <span class="kd">after</span> <span class="m">13</span> <span class="kd">minutes</span> <span class="m">52</span> <span class="kd">seconds</span>

<span class="o">==&gt;</span> <span class="kd">Builds</span> <span class="kd">finished</span>. <span class="kd">The</span> <span class="kd">artifacts</span> <span class="kd">of</span> <span class="kd">successful</span> <span class="kd">builds</span> <span class="kd">are</span>:
<span class="o">--&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s1">'virtualbox'</span> <span class="kd">provider</span> <span class="kd">box</span>: ../../Vagrant/server<span class="o">-</span><span class="m">2019</span>.box
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="building-windows-10-with-packer">Building Windows-10 with Packer</h3>
<p>Every step is the same as server-2019 except here we also provided provisioners which are <code class="language-plaintext highlighter-rouge">setup.ps1</code> and <code class="language-plaintext highlighter-rouge">cleanup.ps1</code>, they run after builders and before SysPrep happens.(So, At Step 9 provisioners run now)</p>

<div class="language-batch highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
</pre></td><td class="rouge-code"><pre><span class="s1">'Command: packer build win10.json'</span>
<span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">output</span> <span class="kd">will</span> <span class="kd">be</span> <span class="k">in</span> <span class="kd">this</span> <span class="nb">color</span>.

<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Retrieving</span> <span class="kd">ISO</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Trying</span> ../../19044.1288.211006<span class="o">-</span><span class="m">0501</span>.21h2_release_svc_refresh_CLIENTENTERPRISEEVAL_OEMRET_x64FRE_en<span class="na">-us</span>.iso
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Trying</span> ../../19044.1288.211006<span class="o">-</span><span class="m">0501</span>.21h2_release_svc_refresh_CLIENTENTERPRISEEVAL_OEMRET_x64FRE_en<span class="na">-us</span>.iso<span class="o">?</span><span class="kd">checksum</span><span class="o">=</span><span class="kd">sha256</span><span class="err">%</span><span class="m">3</span><span class="kd">A69efac1df9ec8066341d8c9b62297ddece0e6b805533fdb6dd66bc8034fba27a</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: ../../19044.1288.211006<span class="o">-</span><span class="m">0501</span>.21h2_release_svc_refresh_CLIENTENTERPRISEEVAL_OEMRET_x64FRE_en<span class="na">-us</span>.iso<span class="o">?</span><span class="kd">checksum</span><span class="o">=</span><span class="kd">sha256</span><span class="err">%</span><span class="m">3</span><span class="kd">A69efac1df9ec8066341d8c9b62297ddece0e6b805533fdb6dd66bc8034fba27a</span> <span class="o">=&gt;</span> <span class="kd">D</span>:/Shared/Auror<span class="na">-Project</span>/19044.1288.211006<span class="o">-</span><span class="m">0501</span>.21h2_release_svc_refresh_CLIENTENTERPRISEEVAL_OEMRET_x64FRE_en<span class="na">-us</span>.iso
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">files</span> <span class="kd">flatly</span> <span class="kd">from</span> <span class="kd">floppy_files</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/autounattend</span>.xml
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/unattend</span>.xml
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/scripts/fixnetwork</span>.ps1
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/scripts/sysprep</span>.bat
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">file</span>: <span class="kd">files</span><span class="na">/scripts/winrmConfig</span>.bat
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Done</span> <span class="kd">copying</span> <span class="kd">files</span> <span class="kd">from</span> <span class="kd">floppy_files</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Collecting</span> <span class="kd">paths</span> <span class="kd">from</span> <span class="kd">floppy_dirs</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Resulting</span> <span class="kd">paths</span> <span class="kd">from</span> <span class="kd">floppy_dirs</span> : <span class="o">[]</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Done</span> <span class="kd">copying</span> <span class="kd">paths</span> <span class="kd">from</span> <span class="kd">floppy_dirs</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Copying</span> <span class="kd">files</span> <span class="kd">from</span> <span class="kd">floppy_content</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Done</span> <span class="kd">copying</span> <span class="kd">files</span> <span class="kd">from</span> <span class="kd">floppy_content</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">ephemeral</span> <span class="kd">key</span> <span class="kd">pair</span> <span class="k">for</span> <span class="kd">SSH</span> <span class="kd">communicator</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Created</span> <span class="kd">ephemeral</span> <span class="kd">SSH</span> <span class="kd">key</span> <span class="kd">pair</span> <span class="k">for</span> <span class="kd">communicator</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">virtual</span> <span class="kd">machine</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">hard</span> <span class="kd">drive</span> <span class="kd">output</span><span class="na">-virtualbox-iso</span>\Windows<span class="o">-</span><span class="m">10</span>.vdi <span class="kd">with</span> <span class="kd">size</span> <span class="m">40960</span> <span class="kd">MiB</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Mounting</span> <span class="kd">ISOs</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Mounting</span> <span class="kd">boot</span> <span class="kd">ISO</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Deleting</span> <span class="kd">any</span> <span class="kd">current</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Attaching</span> <span class="kd">floppy</span> <span class="kd">disk</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Creating</span> <span class="kd">forwarded</span> <span class="kd">port</span> <span class="kd">mapping</span> <span class="k">for</span> <span class="kd">communicator</span> <span class="o">(</span><span class="kd">SSH</span><span class="o">,</span> <span class="kd">WinRM</span><span class="o">,</span> <span class="kd">etc</span><span class="o">)</span> <span class="o">(</span><span class="kd">host</span> <span class="kd">port</span> <span class="m">2305</span><span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span> <span class="kd">custom</span> <span class="kd">VBoxManage</span> <span class="kd">commands</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span>: <span class="kd">modifyvm</span> <span class="kd">Windows</span><span class="o">-</span><span class="m">10</span> <span class="na">--memory </span><span class="m">2048</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Executing</span>: <span class="kd">modifyvm</span> <span class="kd">Windows</span><span class="o">-</span><span class="m">10</span> <span class="na">--cpus </span><span class="m">2</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Starting</span> <span class="kd">the</span> <span class="kd">virtual</span> <span class="kd">machine</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">The</span> <span class="kd">VM</span> <span class="kd">will</span> <span class="kd">be</span> <span class="nb">run</span> <span class="kd">headless</span><span class="o">,</span> <span class="kd">without</span> <span class="kd">a</span> <span class="kd">GUI</span>. <span class="kd">If</span> <span class="kd">you</span> <span class="kd">want</span> <span class="kd">to</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">view</span> <span class="kd">the</span> <span class="kd">screen</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">VM</span><span class="o">,</span> <span class="kd">connect</span> <span class="kd">via</span> <span class="kd">VRDP</span> <span class="kd">without</span> <span class="kd">a</span> <span class="kd">password</span> <span class="kd">to</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">rdp</span>://127.0.0.1:5922
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Waiting</span> <span class="m">5</span><span class="kd">m0s</span> <span class="k">for</span> <span class="kd">boot</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Typing</span> <span class="kd">the</span> <span class="kd">boot</span> <span class="kd">command</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Using</span> <span class="kd">WinRM</span> <span class="kd">communicator</span> <span class="kd">to</span> <span class="kd">connect</span>: <span class="m">127</span>.0.0.1
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">WinRM</span> <span class="kd">to</span> <span class="kd">become</span> <span class="kd">available</span>...
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">WinRM</span> <span class="kd">connected</span>.
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Connected</span> <span class="kd">to</span> <span class="kd">WinRM</span><span class="err">!</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Uploading</span> <span class="kd">VirtualBox</span> <span class="kd">version</span> <span class="kd">info</span> <span class="o">(</span><span class="m">6</span>.1.34<span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Provisioning</span> <span class="kd">with</span> <span class="kd">Powershell</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Provisioning</span> <span class="kd">with</span> <span class="kd">powershell</span> <span class="kd">script</span>: <span class="kd">files</span><span class="na">/scripts/win</span><span class="m">10</span><span class="na">/setup</span>.ps1
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: . : <span class="kd">The</span> <span class="kd">term</span> <span class="s1">'c:/Windows/Temp/packer-ps-env-vars-62b7232d-f0c5-b1e7-3556-5e2df44e229e.ps1'</span> <span class="kd">is</span> <span class="ow">not</span> <span class="kd">recognized</span> <span class="kd">as</span> <span class="kd">the</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">name</span> <span class="kd">of</span> <span class="kd">a</span> <span class="kd">cmdlet</span><span class="o">,</span> <span class="kd">function</span><span class="o">,</span> <span class="kd">script</span> <span class="kd">file</span><span class="o">,</span> <span class="kd">or</span> <span class="kd">operable</span> <span class="kd">program</span>. <span class="kd">Check</span> <span class="kd">the</span> <span class="kd">spelling</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">name</span><span class="o">,</span> <span class="kd">or</span> <span class="k">if</span> <span class="kd">a</span> <span class="nb">path</span> <span class="kd">was</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">included</span><span class="o">,</span> <span class="nb">verify</span> <span class="kd">that</span> <span class="kd">the</span> <span class="nb">path</span> <span class="kd">is</span> <span class="kd">correct</span> <span class="kd">and</span> <span class="kd">try</span> <span class="kd">again</span>.
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">At</span> <span class="kd">line</span>:1 <span class="kd">char</span>:138
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="o">+</span> ... <span class="kd">ontinue</span><span class="s1">'};. c:/Windows/Temp/packer-ps-env-vars-62b7232d-f0c5-b1e7-355 ...
==&gt; virtualbox-iso: +                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
==&gt; virtualbox-iso:     + CategoryInfo          : ObjectNotFound: (c:/Windows/Temp...e2df44e229e.ps1:String) [], CommandNotFoundException
==&gt; virtualbox-iso:     + FullyQualifiedErrorId : CommandNotFoundException
==&gt; virtualbox-iso:
    virtualbox-iso:
    virtualbox-iso:
    virtualbox-iso:     Directory: C:\Users\vagrant\Documents\WindowsPowerShell
    virtualbox-iso:
    virtualbox-iso:
    virtualbox-iso: Mode                 LastWriteTime         Length Name
    virtualbox-iso: ----                 -------------         ------ ----
    virtualbox-iso: -a----         6/25/2022   8:46 PM              0 Microsoft.PowerShell_profile.ps1
==&gt; virtualbox-iso: . : The term '</span><span class="kd">c</span>:/Windows/Temp/packer<span class="na">-ps-env-vars</span><span class="o">-</span><span class="m">62</span><span class="kd">b7232d</span><span class="na">-f</span><span class="m">0</span><span class="kd">c5</span><span class="na">-b</span><span class="m">1</span><span class="kd">e7</span><span class="o">-</span><span class="m">3556</span><span class="o">-</span><span class="m">5</span><span class="kd">e2df44e229e</span>.ps1<span class="s1">' is not recognized as the
==&gt; virtualbox-iso: name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was
==&gt; virtualbox-iso: included, verify that the path is correct and try again.
==&gt; virtualbox-iso: At line:1 char:138
==&gt; virtualbox-iso: + ... ontinue'</span><span class="o">};</span>. <span class="kd">c</span>:/Windows/Temp/packer<span class="na">-ps-env-vars</span><span class="o">-</span><span class="m">62</span><span class="kd">b7232d</span><span class="na">-f</span><span class="m">0</span><span class="kd">c5</span><span class="na">-b</span><span class="m">1</span><span class="kd">e7</span><span class="o">-</span><span class="m">355</span> ...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="o">+</span>                 <span class="o">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>:     <span class="o">+</span> <span class="kd">CategoryInfo</span>          : <span class="kd">ObjectNotFound</span>: <span class="o">(</span><span class="kd">c</span>:/Windows/Temp...e2df44e229e.ps1:String<span class="o">)</span> <span class="o">[],</span> <span class="kd">CommandNotFoundException</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>:     <span class="o">+</span> <span class="kd">FullyQualifiedErrorId</span> : <span class="kd">CommandNotFoundException</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>:
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Pausing</span> <span class="m">1</span><span class="kd">m0s</span> <span class="kd">before</span> <span class="kd">the</span> <span class="kd">next</span> <span class="kd">provisioner</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Provisioning</span> <span class="kd">with</span> <span class="kd">Powershell</span>...
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">Provisioning</span> <span class="kd">with</span> <span class="kd">powershell</span> <span class="kd">script</span>: <span class="kd">files</span><span class="na">/scripts/win</span><span class="m">10</span><span class="na">/cleanup</span>.ps1
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Stop-Service"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"Windows Update (wuauserv)"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb.chk"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00001.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00002.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00003.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00004.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00005.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00006.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00007.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edb00008.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edbres00001.jrs"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edbres00002.jrs"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\Logs\edbtmp.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\DataStore.edb"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\DataStore\DataStore.jfm"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\Download"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\Download\SharedFileCache"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\PostRebootEventCache.V2"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\SLS"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\2B81F1BF-356C-4FA1-90F1-7581A62C6764"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\2B81F1BF-356C-4FA1-90F1-7581A62C6764\sls.cab"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\855E8A7C-ECB4-4CA3-B045-1DFA50104289"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\855E8A7C-ECB4-4CA3-B045-1DFA50104289\sls.cab"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\8B24B027-1DEE-BABB-9A95-3517DFB9C552"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\8B24B027-1DEE-BABB-9A95-3517DFB9C552\sls.cab"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\9482F4B4-E343-43B6-B170-9A65BC822C77"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\SoftwareDistribution\SLS\9482F4B4-E343-43B6-B170-9A65BC822C77\sls.cab"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\SoftwareDistribution\ReportingEvents.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\MsEdgeCrashpad"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove Directory"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\MsEdgeCrashpad\reports"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\MsEdgeCrashpad\metadata"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\MsEdgeCrashpad\settings.dat"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\MsEdgeCrashpad\throttle_store.dat"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\FXSAPIDebugLogFile.txt"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\FXSTIFFDebugLogFile.txt"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\MpCmdRun.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\msedge_installer.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\Temp\packer-ps-env-vars-62b7232d-d8ff-aa3a-a04a-0cc85e8c21f5.ps1"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span>
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="s2">"C:\Windows\Temp\script-62b7232d-2ab7-b3a3-a45e-7886f2be0234.ps1"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Windows\Temp\wmsetup.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\users\vagrant\AppData\Local\Temp\msedge_installer.log"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\users\vagrant\AppData\Local\Temp\wct1DC5.tmp"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\users\vagrant\AppData\Local\Temp\wct4F64.tmp"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\users\vagrant\AppData\Local\Temp\wct99CB.tmp"</span>.
    <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\users\vagrant\AppData\Local\Temp\wmsetup.log"</span>.
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: . : <span class="kd">The</span> <span class="kd">term</span> <span class="s1">'c:/Windows/Temp/packer-ps-env-vars-62b7232d-d8ff-aa3a-a04a-0cc85e8c21f5.ps1'</span> <span class="kd">is</span> <span class="ow">not</span> <span class="kd">recognized</span> <span class="kd">as</span> <span class="kd">the</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">name</span> <span class="kd">of</span> <span class="kd">a</span> <span class="kd">cmdlet</span><span class="o">,</span> <span class="kd">function</span><span class="o">,</span> <span class="kd">script</span> <span class="kd">file</span><span class="o">,</span> <span class="kd">or</span> <span class="kd">operable</span> <span class="kd">program</span>. <span class="kd">Check</span> <span class="kd">the</span> <span class="kd">spelling</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">name</span><span class="o">,</span> <span class="kd">or</span> <span class="k">if</span> <span class="kd">a</span> <span class="nb">path</span> <span class="kd">was</span>
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">included</span><span class="o">,</span> <span class="nb">verify</span> <span class="kd">that</span> <span class="kd">the</span> <span class="nb">path</span> <span class="kd">is</span> <span class="kd">correct</span> <span class="kd">and</span> <span class="kd">try</span> <span class="kd">again</span>.
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="kd">At</span> <span class="kd">line</span>:1 <span class="kd">char</span>:138
<span class="o">==&gt;</span> <span class="kd">virtualbox</span><span class="na">-iso</span>: <span class="o">+</span> ... <span class="kd">ontinue</span><span class="s1">'};. c:/Windows/Temp/packer-ps-env-vars-62b7232d-d8ff-aa3a-a04 ...
==&gt; virtualbox-iso: +                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
==&gt; virtualbox-iso:     + CategoryInfo          : ObjectNotFound: (c:/Windows/Temp...cc85e8c21f5.ps1:String) [], CommandNotFoundException
==&gt; virtualbox-iso:     + FullyQualifiedErrorId : CommandNotFoundException
==&gt; virtualbox-iso:
==&gt; virtualbox-iso: Gracefully halting virtual machine...
    virtualbox-iso:
    virtualbox-iso: C:\Users\vagrant&gt;net stop tiledatamodelsvc
    virtualbox-iso:
    virtualbox-iso: C:\Users\vagrant&gt;c:\windows\system32\sysprep\sysprep.exe /generalize /mode:vm /oobe /unattend:a:\unattend.xml
==&gt; virtualbox-iso: The service name is invalid.
==&gt; virtualbox-iso:
==&gt; virtualbox-iso: More help is available by typing NET HELPMSG 2185.
==&gt; virtualbox-iso:
    virtualbox-iso:
    virtualbox-iso: C:\Users\vagrant&gt;shutdown /s
==&gt; virtualbox-iso: A system shutdown is in progress.(1115)
    virtualbox-iso: Removing floppy drive...
==&gt; virtualbox-iso: Preparing to export machine...
    virtualbox-iso: Deleting forwarded port mapping for the communicator (SSH, WinRM, etc) (host port 2305)
==&gt; virtualbox-iso: Exporting virtual machine...
    virtualbox-iso: Executing: export Windows-10 --output output-virtualbox-iso\Windows-10.ovf
==&gt; virtualbox-iso: Cleaning up floppy disk...
==&gt; virtualbox-iso: Error unregistering floppy: VBoxManage error: VBoxManage.exe: error: Could not find a controller named '</span><span class="kd">Floppy</span> <span class="kd">Controller</span><span class="s1">'. Not considering this a critical failure; build will continue.
==&gt; virtualbox-iso: Deregistering and deleting VM...
==&gt; virtualbox-iso: Running post-processor: vagrant
==&gt; virtualbox-iso (vagrant): Creating a dummy Vagrant box to ensure the host system can create one correctly
==&gt; virtualbox-iso (vagrant): Creating Vagrant box for '</span><span class="kd">virtualbox</span><span class="s1">' provider
    virtualbox-iso (vagrant): Copying from artifact: output-virtualbox-iso\Windows-10-disk001.vmdk
    virtualbox-iso (vagrant): Copying from artifact: output-virtualbox-iso\Windows-10.ovf
    virtualbox-iso (vagrant): Renaming the OVF to box.ovf...
    virtualbox-iso (vagrant): Using custom Vagrantfile: win10-vagrantfile.template
    virtualbox-iso (vagrant): Compressing: Vagrantfile
    virtualbox-iso (vagrant): Compressing: Windows-10-disk001.vmdk
    virtualbox-iso (vagrant): Compressing: box.ovf
    virtualbox-iso (vagrant): Compressing: metadata.json
Build '</span><span class="kd">virtualbox</span><span class="na">-iso</span><span class="s1">' finished after 19 minutes 17 seconds.

==&gt; Wait completed after 19 minutes 17 seconds

==&gt; Builds finished. The artifacts of successful builds are:
--&gt; virtualbox-iso: '</span><span class="kd">virtualbox</span><span class="s1">' provider box: ../../Vagrant/win10.box
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="setting-up-the-environment-using-vagrant">Setting up the environment using Vagrant</h3>
<ol>
  <li>Brings up dc01 and pc01 VMs and prepares the base image for the clone by importing .box files</li>
  <li>Clones VM, sets up name, network configuration and forwards required ports for communication like RDP, WinRM and SSH</li>
  <li>Boots VM and waits to connect to a communicator</li>
  <li>Tries to find Guest additions (because I‚Äôve shared clipboard and VRAM set in vagrantfile) and if not, installs guest additions and Set the required VM configuration</li>
  <li>Mounts the current directory to run provisioners which are <code class="language-plaintext highlighter-rouge">set-timezone.ps1</code>, then <code class="language-plaintext highlighter-rouge">install-active-directory.ps1</code>(which installs ADDS, then performs DCPromo) and <code class="language-plaintext highlighter-rouge">add-adam.ps1</code> for DC01</li>
</ol>

<p>Same steps for PC01, except the provisioner scripts here are different. 
<code class="language-plaintext highlighter-rouge">install-chrome.ps1</code> installs Google chrome, then <code class="language-plaintext highlighter-rouge">join-domain.ps1</code> joins PC01 to <code class="language-plaintext highlighter-rouge">auror.local</code> domain and <code class="language-plaintext highlighter-rouge">add-localadmin.ps1</code> makes Adam a localadmin for PC01.</p>

<div class="language-batch highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
</pre></td><td class="rouge-code"><pre><span class="kd">D</span>:\Shared\Auror<span class="na">-Project</span><span class="o">&gt;</span><span class="nb">cd</span> <span class="kd">vagrant</span> <span class="o">&amp;&amp;</span> <span class="kd">vagrant</span> <span class="kd">up</span>
<span class="kd">Bringing</span> <span class="kd">machine</span> <span class="s1">'dc01'</span> <span class="kd">up</span> <span class="kd">with</span> <span class="s1">'virtualbox'</span> <span class="kd">provider</span>...
<span class="kd">Bringing</span> <span class="kd">machine</span> <span class="s1">'pc01'</span> <span class="kd">up</span> <span class="kd">with</span> <span class="s1">'virtualbox'</span> <span class="kd">provider</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Preparing</span> <span class="kd">master</span> <span class="kd">VM</span> <span class="k">for</span> <span class="kd">linked</span> <span class="kd">clones</span>...
    <span class="kd">dc01</span>: <span class="kd">This</span> <span class="kd">is</span> <span class="kd">a</span> <span class="kd">one</span> <span class="nb">time</span> <span class="kd">operation</span>. <span class="kd">Once</span> <span class="kd">the</span> <span class="kd">master</span> <span class="kd">VM</span> <span class="kd">is</span> <span class="kd">prepared</span><span class="o">,</span>
    <span class="kd">dc01</span>: <span class="kd">it</span> <span class="kd">will</span> <span class="kd">be</span> <span class="kd">used</span> <span class="kd">as</span> <span class="kd">a</span> <span class="kd">base</span> <span class="k">for</span> <span class="kd">linked</span> <span class="kd">clones</span><span class="o">,</span> <span class="kd">making</span> <span class="kd">the</span> <span class="kd">creation</span>
    <span class="kd">dc01</span>: <span class="kd">of</span> <span class="kd">new</span> <span class="kd">VMs</span> <span class="kd">take</span> <span class="kd">milliseconds</span> <span class="na">on</span> <span class="kd">a</span> <span class="kd">modern</span> <span class="kd">system</span>.
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Importing</span> <span class="kd">base</span> <span class="kd">box</span> <span class="s1">'server-2019.box'</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Cloning</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Matching</span> <span class="kd">MAC</span> <span class="kd">address</span> <span class="k">for</span> <span class="kd">NAT</span> <span class="kd">networking</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Setting</span> <span class="kd">the</span> <span class="kd">name</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">VM</span>: <span class="kd">DC01</span>
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Clearing</span> <span class="kd">any</span> <span class="kd">previously</span> <span class="kd">set</span> <span class="kd">network</span> <span class="kd">interfaces</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Preparing</span> <span class="kd">network</span> <span class="kd">interfaces</span> <span class="kd">based</span> <span class="na">on</span> <span class="kd">configuration</span>...
    <span class="kd">dc01</span>: <span class="kd">Adapter</span> <span class="m">1</span>: <span class="kd">nat</span>
    <span class="kd">dc01</span>: <span class="kd">Adapter</span> <span class="m">2</span>: <span class="kd">hostonly</span>
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Forwarding</span> <span class="kd">ports</span>...
    <span class="kd">dc01</span>: <span class="m">3389</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">3389</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
    <span class="kd">dc01</span>: <span class="m">5985</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">55985</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
    <span class="kd">dc01</span>: <span class="m">5986</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">55986</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
    <span class="kd">dc01</span>: <span class="m">22</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">2222</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="s1">'pre-boot'</span> <span class="kd">VM</span> <span class="kd">customizations</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Booting</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">boot</span>. <span class="kd">This</span> <span class="kd">may</span> <span class="kd">take</span> <span class="kd">a</span> <span class="kd">few</span> <span class="kd">minutes</span>...
    <span class="kd">dc01</span>: <span class="kd">WinRM</span> <span class="kd">address</span>: <span class="m">127</span>.0.0.1:55985
    <span class="kd">dc01</span>: <span class="kd">WinRM</span> <span class="kd">username</span>: <span class="kd">vagrant</span>
    <span class="kd">dc01</span>: <span class="kd">WinRM</span> <span class="kd">execution_time_limit</span>: <span class="kd">PT2H</span>
    <span class="kd">dc01</span>: <span class="kd">WinRM</span> <span class="kd">transport</span>: <span class="kd">plaintext</span>
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Machine</span> <span class="kd">booted</span> <span class="kd">and</span> <span class="kd">ready</span><span class="err">!</span>
<span class="o">[</span><span class="kd">dc01</span><span class="o">]</span> <span class="kd">No</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="kd">installation</span> <span class="kd">found</span>.
<span class="kd">Copy</span> <span class="kd">iso</span> <span class="kd">file</span> <span class="kd">C</span>:\Program <span class="kd">Files</span>\Oracle\VirtualBox\VBoxGuestAdditions.iso <span class="kd">into</span> <span class="kd">the</span> <span class="kd">box</span> $env:TEMP/VBoxGuestAdditions.iso


<span class="kd">Attached</span>          : <span class="kd">True</span>
<span class="kd">BlockSize</span>         : <span class="m">0</span>
<span class="kd">DevicePath</span>        : \\.\CDROM0
<span class="kd">FileSize</span>          : <span class="m">61538304</span>
<span class="kd">ImagePath</span>         : <span class="kd">C</span>:\Users\vagrant\AppData\Local\Temp/VBoxGuestAdditions.iso
<span class="kd">LogicalSectorSize</span> : <span class="m">2048</span>
<span class="kd">Number</span>            : <span class="m">0</span>
<span class="kd">Size</span>              : <span class="m">61538304</span>
<span class="kd">StorageType</span>       : <span class="m">1</span>
<span class="kd">PSComputerName</span>    :



<span class="kd">Mounting</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="kd">ISO</span> <span class="kd">to</span>: <span class="kd">D</span>
<span class="kd">Installing</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="m">6</span>.1.34 <span class="o">-</span> <span class="kd">guest</span> <span class="kd">version</span> <span class="kd">is</span> <span class="kd">unknown</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha1.cer'</span> <span class="kd">as</span> <span class="kd">trusted</span> <span class="kd">publisher</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha256.cer'</span> <span class="kd">as</span> <span class="kd">trusted</span> <span class="kd">publisher</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha1.cer'</span> <span class="kd">as</span> <span class="kd">root</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha256.cer'</span> <span class="kd">as</span> <span class="kd">root</span>
<span class="kd">Unmounting</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="kd">ISO</span> <span class="kd">from</span>: <span class="kd">D</span>


<span class="kd">Attached</span>          : <span class="kd">False</span>
<span class="kd">BlockSize</span>         : <span class="m">0</span>
<span class="kd">DevicePath</span>        :
<span class="kd">FileSize</span>          : <span class="m">61538304</span>
<span class="kd">ImagePath</span>         : <span class="kd">C</span>:\Users\vagrant\AppData\Local\Temp/VBoxGuestAdditions.iso
<span class="kd">LogicalSectorSize</span> : <span class="m">2048</span>
<span class="kd">Number</span>            :
<span class="kd">Size</span>              : <span class="m">61538304</span>
<span class="kd">StorageType</span>       : <span class="m">1</span>
<span class="kd">PSComputerName</span>    :



<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Checking</span> <span class="k">for</span> <span class="kd">guest</span> <span class="kd">additions</span> <span class="k">in</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Setting</span> <span class="nb">hostname</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Configuring</span> <span class="kd">and</span> <span class="kd">enabling</span> <span class="kd">network</span> <span class="kd">interfaces</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Mounting</span> <span class="kd">shared</span> <span class="kd">folders</span>...
    <span class="kd">dc01</span>: <span class="na">/vagrant </span><span class="o">=&gt;</span> <span class="kd">D</span>:/Shared/Auror<span class="na">-Project/Vagrant
</span><span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
    <span class="kd">dc01</span>: <span class="kd">Running</span>: ./files/set<span class="na">-timezone</span>.ps1 <span class="kd">as</span> <span class="kd">C</span>:\tmp\vagrant<span class="na">-shell</span>.ps1
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
    <span class="kd">dc01</span>: <span class="kd">Running</span>: ./files/install<span class="na">-active-directory</span>.ps1 <span class="kd">as</span> <span class="kd">C</span>:\tmp\vagrant<span class="na">-shell</span>.ps1
    <span class="kd">dc01</span>: <span class="kd">Removing</span> <span class="kd">default</span> <span class="kd">password</span> <span class="kd">complexity</span> <span class="kd">policy</span>...
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">The</span> <span class="kd">task</span> <span class="kd">has</span> <span class="kd">completed</span> <span class="kd">successfully</span>.
    <span class="kd">dc01</span>: <span class="kd">See</span> <span class="kd">log</span> <span class="nv">%windir%</span>\security\logs\scesrv.log <span class="k">for</span> <span class="kd">detail</span> <span class="kd">info</span>.
<span class="kd">Completed</span> <span class="m">100</span> <span class="kd">percent</span> <span class="o">(</span><span class="m">18</span>/18<span class="o">)</span> <span class="o">(</span><span class="m">0</span><span class="kd">Process</span> <span class="kd">Security</span> <span class="kd">Policy</span> <span class="kd">area</span>
    <span class="kd">dc01</span>: <span class="kd">The</span> <span class="kd">task</span> <span class="kd">has</span> <span class="kd">completed</span> <span class="kd">successfully</span>.
    <span class="kd">dc01</span>: <span class="kd">See</span> <span class="kd">log</span> <span class="nv">%windir%</span>\security\logs\scesrv.log <span class="k">for</span> <span class="kd">detail</span> <span class="kd">info</span>.
    <span class="kd">dc01</span>: <span class="kd">Setting</span> <span class="kd">DNS</span> <span class="kd">server</span> <span class="kd">addresses</span>. . .
    <span class="kd">dc01</span>: <span class="kd">Installing</span> <span class="kd">Active</span> <span class="kd">Directory</span> <span class="kd">features</span>. . .
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">Success</span> <span class="kd">Restart</span> <span class="kd">Needed</span> <span class="kd">Exit</span> <span class="kd">Code</span>      <span class="kd">Feature</span> <span class="kd">Result</span>
    <span class="kd">dc01</span>: <span class="o">-------</span> <span class="o">--------------</span> <span class="o">---------</span>      <span class="o">--------------</span>
    <span class="kd">dc01</span>: <span class="kd">True</span>    <span class="kd">No</span>             <span class="kd">Success</span>        <span class="o">{</span><span class="kd">Active</span> <span class="kd">Directory</span> <span class="kd">Domain</span> <span class="kd">Services</span><span class="o">,</span> <span class="kd">Remote</span> ...
    <span class="kd">dc01</span>: <span class="kd">Creating</span> <span class="kd">Active</span> <span class="kd">Directory</span> <span class="kd">forest</span>. . .
    <span class="kd">dc01</span>: <span class="kd">WARNING</span>: <span class="kd">Windows</span> <span class="kd">Server</span> <span class="m">2019</span> <span class="kd">domain</span> <span class="kd">controllers</span> <span class="kd">have</span> <span class="kd">a</span> <span class="kd">default</span> <span class="k">for</span> <span class="kd">the</span> <span class="kd">security</span> <span class="kd">setting</span> <span class="kd">named</span> <span class="s2">"Allow cryptography
    dc01: algorithms compatible with Windows NT 4.0"</span> <span class="kd">that</span> <span class="kd">prevents</span> <span class="kd">weaker</span> <span class="kd">cryptography</span> <span class="kd">algorithms</span> <span class="kd">when</span> <span class="kd">establishing</span> <span class="kd">security</span>
    <span class="kd">dc01</span>: <span class="kd">channel</span> <span class="kd">sessions</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">For</span> <span class="nb">more</span> <span class="kd">information</span> <span class="kd">about</span> <span class="kd">this</span> <span class="kd">setting</span><span class="o">,</span> <span class="kd">see</span> <span class="kd">Knowledge</span> <span class="kd">Base</span> <span class="kd">article</span> <span class="m">942564</span>
    <span class="kd">dc01</span>: <span class="o">(</span><span class="kd">http</span>://go.microsoft.com/fwlink/<span class="o">?</span><span class="kd">LinkId</span><span class="o">=</span><span class="m">104751</span><span class="o">)</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">WARNING</span>: <span class="kd">This</span> <span class="kd">computer</span> <span class="kd">has</span> <span class="nb">at</span> <span class="kd">least</span> <span class="kd">one</span> <span class="kd">physical</span> <span class="kd">network</span> <span class="kd">adapter</span> <span class="kd">that</span> <span class="kd">does</span> <span class="ow">not</span> <span class="kd">have</span> <span class="kd">static</span> <span class="kd">IP</span> <span class="kd">address</span><span class="o">(</span><span class="kd">es</span><span class="o">)</span> <span class="kd">assigned</span> <span class="kd">to</span>
    <span class="kd">dc01</span>: <span class="kd">its</span> <span class="kd">IP</span> <span class="kd">Properties</span>. <span class="kd">If</span> <span class="kd">both</span> <span class="kd">IPv4</span> <span class="kd">and</span> <span class="kd">IPv6</span> <span class="kd">are</span> <span class="kd">enabled</span> <span class="k">for</span> <span class="kd">a</span> <span class="kd">network</span> <span class="kd">adapter</span><span class="o">,</span> <span class="kd">both</span> <span class="kd">IPv4</span> <span class="kd">and</span> <span class="kd">IPv6</span> <span class="kd">static</span> <span class="kd">IP</span> <span class="kd">addresses</span>
    <span class="kd">dc01</span>: <span class="kd">should</span> <span class="kd">be</span> <span class="kd">assigned</span> <span class="kd">to</span> <span class="kd">both</span> <span class="kd">IPv4</span> <span class="kd">and</span> <span class="kd">IPv6</span> <span class="kd">Properties</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">physical</span> <span class="kd">network</span> <span class="kd">adapter</span>. <span class="kd">Such</span> <span class="kd">static</span> <span class="kd">IP</span> <span class="kd">address</span><span class="o">(</span><span class="kd">es</span><span class="o">)</span>
    <span class="kd">dc01</span>: <span class="kd">assignment</span> <span class="kd">should</span> <span class="kd">be</span> <span class="kd">done</span> <span class="kd">to</span> <span class="kd">all</span> <span class="kd">the</span> <span class="kd">physical</span> <span class="kd">network</span> <span class="kd">adapters</span> <span class="k">for</span> <span class="kd">reliable</span> <span class="kd">Domain</span> <span class="kd">Name</span> <span class="kd">System</span> <span class="o">(</span><span class="kd">DNS</span><span class="o">)</span> <span class="kd">operation</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">WARNING</span>: <span class="kd">A</span> <span class="kd">delegation</span> <span class="k">for</span> <span class="kd">this</span> <span class="kd">DNS</span> <span class="kd">server</span> <span class="kd">cannot</span> <span class="kd">be</span> <span class="kd">created</span> <span class="kd">because</span> <span class="kd">the</span> <span class="kd">authoritative</span> <span class="kd">parent</span> <span class="kd">zone</span> <span class="kd">cannot</span> <span class="kd">be</span> <span class="kd">found</span> <span class="kd">or</span> <span class="kd">it</span>
    <span class="kd">dc01</span>:  <span class="kd">does</span> <span class="ow">not</span> <span class="nb">run</span> <span class="kd">Windows</span> <span class="kd">DNS</span> <span class="kd">server</span>. <span class="kd">If</span> <span class="kd">you</span> <span class="kd">are</span> <span class="kd">integrating</span> <span class="kd">with</span> <span class="kd">an</span> <span class="kd">existing</span> <span class="kd">DNS</span> <span class="kd">infrastructure</span><span class="o">,</span> <span class="kd">you</span> <span class="kd">should</span> <span class="kd">manually</span>
    <span class="kd">dc01</span>: <span class="kd">create</span> <span class="kd">a</span> <span class="kd">delegation</span> <span class="kd">to</span> <span class="kd">this</span> <span class="kd">DNS</span> <span class="kd">server</span> <span class="k">in</span> <span class="kd">the</span> <span class="kd">parent</span> <span class="kd">zone</span> <span class="kd">to</span> <span class="kd">ensure</span> <span class="kd">reliable</span> <span class="kd">name</span> <span class="kd">resolution</span> <span class="kd">from</span> <span class="kd">outside</span> <span class="kd">the</span> <span class="kd">domain</span>
    <span class="kd">dc01</span>: <span class="s2">"auror.local"</span>. <span class="kd">Otherwise</span><span class="o">,</span> <span class="kd">no</span> <span class="kd">action</span> <span class="kd">is</span> <span class="kd">required</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">WARNING</span>: <span class="kd">Windows</span> <span class="kd">Server</span> <span class="m">2019</span> <span class="kd">domain</span> <span class="kd">controllers</span> <span class="kd">have</span> <span class="kd">a</span> <span class="kd">default</span> <span class="k">for</span> <span class="kd">the</span> <span class="kd">security</span> <span class="kd">setting</span> <span class="kd">named</span> <span class="s2">"Allow cryptography
    dc01: algorithms compatible with Windows NT 4.0"</span> <span class="kd">that</span> <span class="kd">prevents</span> <span class="kd">weaker</span> <span class="kd">cryptography</span> <span class="kd">algorithms</span> <span class="kd">when</span> <span class="kd">establishing</span> <span class="kd">security</span>
    <span class="kd">dc01</span>: <span class="kd">channel</span> <span class="kd">sessions</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">For</span> <span class="nb">more</span> <span class="kd">information</span> <span class="kd">about</span> <span class="kd">this</span> <span class="kd">setting</span><span class="o">,</span> <span class="kd">see</span> <span class="kd">Knowledge</span> <span class="kd">Base</span> <span class="kd">article</span> <span class="m">942564</span>
    <span class="kd">dc01</span>: <span class="o">(</span><span class="kd">http</span>://go.microsoft.com/fwlink/<span class="o">?</span><span class="kd">LinkId</span><span class="o">=</span><span class="m">104751</span><span class="o">)</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">WARNING</span>: <span class="kd">This</span> <span class="kd">computer</span> <span class="kd">has</span> <span class="nb">at</span> <span class="kd">least</span> <span class="kd">one</span> <span class="kd">physical</span> <span class="kd">network</span> <span class="kd">adapter</span> <span class="kd">that</span> <span class="kd">does</span> <span class="ow">not</span> <span class="kd">have</span> <span class="kd">static</span> <span class="kd">IP</span> <span class="kd">address</span><span class="o">(</span><span class="kd">es</span><span class="o">)</span> <span class="kd">assigned</span> <span class="kd">to</span>
    <span class="kd">dc01</span>: <span class="kd">its</span> <span class="kd">IP</span> <span class="kd">Properties</span>. <span class="kd">If</span> <span class="kd">both</span> <span class="kd">IPv4</span> <span class="kd">and</span> <span class="kd">IPv6</span> <span class="kd">are</span> <span class="kd">enabled</span> <span class="k">for</span> <span class="kd">a</span> <span class="kd">network</span> <span class="kd">adapter</span><span class="o">,</span> <span class="kd">both</span> <span class="kd">IPv4</span> <span class="kd">and</span> <span class="kd">IPv6</span> <span class="kd">static</span> <span class="kd">IP</span> <span class="kd">addresses</span>
    <span class="kd">dc01</span>: <span class="kd">should</span> <span class="kd">be</span> <span class="kd">assigned</span> <span class="kd">to</span> <span class="kd">both</span> <span class="kd">IPv4</span> <span class="kd">and</span> <span class="kd">IPv6</span> <span class="kd">Properties</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">physical</span> <span class="kd">network</span> <span class="kd">adapter</span>. <span class="kd">Such</span> <span class="kd">static</span> <span class="kd">IP</span> <span class="kd">address</span><span class="o">(</span><span class="kd">es</span><span class="o">)</span>
    <span class="kd">dc01</span>: <span class="kd">assignment</span> <span class="kd">should</span> <span class="kd">be</span> <span class="kd">done</span> <span class="kd">to</span> <span class="kd">all</span> <span class="kd">the</span> <span class="kd">physical</span> <span class="kd">network</span> <span class="kd">adapters</span> <span class="k">for</span> <span class="kd">reliable</span> <span class="kd">Domain</span> <span class="kd">Name</span> <span class="kd">System</span> <span class="o">(</span><span class="kd">DNS</span><span class="o">)</span> <span class="kd">operation</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">WARNING</span>: <span class="kd">A</span> <span class="kd">delegation</span> <span class="k">for</span> <span class="kd">this</span> <span class="kd">DNS</span> <span class="kd">server</span> <span class="kd">cannot</span> <span class="kd">be</span> <span class="kd">created</span> <span class="kd">because</span> <span class="kd">the</span> <span class="kd">authoritative</span> <span class="kd">parent</span> <span class="kd">zone</span> <span class="kd">cannot</span> <span class="kd">be</span> <span class="kd">found</span> <span class="kd">or</span> <span class="kd">it</span>
    <span class="kd">dc01</span>:  <span class="kd">does</span> <span class="ow">not</span> <span class="nb">run</span> <span class="kd">Windows</span> <span class="kd">DNS</span> <span class="kd">server</span>. <span class="kd">If</span> <span class="kd">you</span> <span class="kd">are</span> <span class="kd">integrating</span> <span class="kd">with</span> <span class="kd">an</span> <span class="kd">existing</span> <span class="kd">DNS</span> <span class="kd">infrastructure</span><span class="o">,</span> <span class="kd">you</span> <span class="kd">should</span> <span class="kd">manually</span>
    <span class="kd">dc01</span>: <span class="kd">create</span> <span class="kd">a</span> <span class="kd">delegation</span> <span class="kd">to</span> <span class="kd">this</span> <span class="kd">DNS</span> <span class="kd">server</span> <span class="k">in</span> <span class="kd">the</span> <span class="kd">parent</span> <span class="kd">zone</span> <span class="kd">to</span> <span class="kd">ensure</span> <span class="kd">reliable</span> <span class="kd">name</span> <span class="kd">resolution</span> <span class="kd">from</span> <span class="kd">outside</span> <span class="kd">the</span> <span class="kd">domain</span>
    <span class="kd">dc01</span>: <span class="s2">"auror.local"</span>. <span class="kd">Otherwise</span><span class="o">,</span> <span class="kd">no</span> <span class="kd">action</span> <span class="kd">is</span> <span class="kd">required</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">Message</span>        : <span class="kd">You</span> <span class="kd">must</span> <span class="kd">restart</span> <span class="kd">this</span> <span class="kd">computer</span> <span class="kd">to</span> <span class="kd">complete</span> <span class="kd">the</span> <span class="kd">operation</span>.
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>: <span class="kd">Context</span>        : <span class="kd">DCPromo</span>.General.2
    <span class="kd">dc01</span>: <span class="kd">RebootRequired</span> : <span class="kd">True</span>
    <span class="kd">dc01</span>: <span class="kd">Status</span>         : <span class="kd">Success</span>
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>:
    <span class="kd">dc01</span>:
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
    <span class="kd">dc01</span>: <span class="kd">Running</span>: ./files/add<span class="na">-adam</span>.ps1 <span class="kd">as</span> <span class="kd">C</span>:\tmp\vagrant<span class="na">-shell</span>.ps1
    <span class="kd">dc01</span>: <span class="kd">The</span> <span class="kd">command</span> <span class="kd">completed</span> <span class="kd">successfully</span>.
    <span class="kd">dc01</span>:
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
<span class="o">==&gt;</span> <span class="kd">dc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Preparing</span> <span class="kd">master</span> <span class="kd">VM</span> <span class="k">for</span> <span class="kd">linked</span> <span class="kd">clones</span>...
    <span class="kd">pc01</span>: <span class="kd">This</span> <span class="kd">is</span> <span class="kd">a</span> <span class="kd">one</span> <span class="nb">time</span> <span class="kd">operation</span>. <span class="kd">Once</span> <span class="kd">the</span> <span class="kd">master</span> <span class="kd">VM</span> <span class="kd">is</span> <span class="kd">prepared</span><span class="o">,</span>
    <span class="kd">pc01</span>: <span class="kd">it</span> <span class="kd">will</span> <span class="kd">be</span> <span class="kd">used</span> <span class="kd">as</span> <span class="kd">a</span> <span class="kd">base</span> <span class="k">for</span> <span class="kd">linked</span> <span class="kd">clones</span><span class="o">,</span> <span class="kd">making</span> <span class="kd">the</span> <span class="kd">creation</span>
    <span class="kd">pc01</span>: <span class="kd">of</span> <span class="kd">new</span> <span class="kd">VMs</span> <span class="kd">take</span> <span class="kd">milliseconds</span> <span class="na">on</span> <span class="kd">a</span> <span class="kd">modern</span> <span class="kd">system</span>.
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Importing</span> <span class="kd">base</span> <span class="kd">box</span> <span class="s1">'win10.box'</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Cloning</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Matching</span> <span class="kd">MAC</span> <span class="kd">address</span> <span class="k">for</span> <span class="kd">NAT</span> <span class="kd">networking</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Setting</span> <span class="kd">the</span> <span class="kd">name</span> <span class="kd">of</span> <span class="kd">the</span> <span class="kd">VM</span>: <span class="kd">PC01</span>
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Fixed</span> <span class="kd">port</span> <span class="kd">collision</span> <span class="k">for</span> <span class="m">3389</span> <span class="o">=&gt;</span> <span class="m">3389</span>. <span class="kd">Now</span> <span class="na">on</span> <span class="kd">port</span> <span class="m">2200</span>.
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Fixed</span> <span class="kd">port</span> <span class="kd">collision</span> <span class="k">for</span> <span class="m">5985</span> <span class="o">=&gt;</span> <span class="m">55985</span>. <span class="kd">Now</span> <span class="na">on</span> <span class="kd">port</span> <span class="m">2201</span>.
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Fixed</span> <span class="kd">port</span> <span class="kd">collision</span> <span class="k">for</span> <span class="m">5986</span> <span class="o">=&gt;</span> <span class="m">55986</span>. <span class="kd">Now</span> <span class="na">on</span> <span class="kd">port</span> <span class="m">2202</span>.
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Fixed</span> <span class="kd">port</span> <span class="kd">collision</span> <span class="k">for</span> <span class="m">22</span> <span class="o">=&gt;</span> <span class="m">2222</span>. <span class="kd">Now</span> <span class="na">on</span> <span class="kd">port</span> <span class="m">2203</span>.
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Clearing</span> <span class="kd">any</span> <span class="kd">previously</span> <span class="kd">set</span> <span class="kd">network</span> <span class="kd">interfaces</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Preparing</span> <span class="kd">network</span> <span class="kd">interfaces</span> <span class="kd">based</span> <span class="na">on</span> <span class="kd">configuration</span>...
    <span class="kd">pc01</span>: <span class="kd">Adapter</span> <span class="m">1</span>: <span class="kd">nat</span>
    <span class="kd">pc01</span>: <span class="kd">Adapter</span> <span class="m">2</span>: <span class="kd">hostonly</span>
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Forwarding</span> <span class="kd">ports</span>...
    <span class="kd">pc01</span>: <span class="m">3389</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">2200</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
    <span class="kd">pc01</span>: <span class="m">5985</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">2201</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
    <span class="kd">pc01</span>: <span class="m">5986</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">2202</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
    <span class="kd">pc01</span>: <span class="m">22</span> <span class="o">(</span><span class="kd">guest</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="m">2203</span> <span class="o">(</span><span class="kd">host</span><span class="o">)</span> <span class="o">(</span><span class="kd">adapter</span> <span class="m">1</span><span class="o">)</span>
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="s1">'pre-boot'</span> <span class="kd">VM</span> <span class="kd">customizations</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Booting</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">boot</span>. <span class="kd">This</span> <span class="kd">may</span> <span class="kd">take</span> <span class="kd">a</span> <span class="kd">few</span> <span class="kd">minutes</span>...
    <span class="kd">pc01</span>: <span class="kd">WinRM</span> <span class="kd">address</span>: <span class="m">127</span>.0.0.1:2201
    <span class="kd">pc01</span>: <span class="kd">WinRM</span> <span class="kd">username</span>: <span class="kd">vagrant</span>
    <span class="kd">pc01</span>: <span class="kd">WinRM</span> <span class="kd">execution_time_limit</span>: <span class="kd">PT2H</span>
    <span class="kd">pc01</span>: <span class="kd">WinRM</span> <span class="kd">transport</span>: <span class="kd">plaintext</span>
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Machine</span> <span class="kd">booted</span> <span class="kd">and</span> <span class="kd">ready</span><span class="err">!</span>
<span class="o">[</span><span class="kd">pc01</span><span class="o">]</span> <span class="kd">No</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="kd">installation</span> <span class="kd">found</span>.
<span class="kd">Copy</span> <span class="kd">iso</span> <span class="kd">file</span> <span class="kd">C</span>:\Program <span class="kd">Files</span>\Oracle\VirtualBox\VBoxGuestAdditions.iso <span class="kd">into</span> <span class="kd">the</span> <span class="kd">box</span> $env:TEMP/VBoxGuestAdditions.iso


<span class="kd">Attached</span>          : <span class="kd">True</span>
<span class="kd">BlockSize</span>         : <span class="m">0</span>
<span class="kd">DevicePath</span>        : \\.\CDROM0
<span class="kd">FileSize</span>          : <span class="m">61538304</span>
<span class="kd">ImagePath</span>         : <span class="kd">C</span>:\Users\vagrant\AppData\Local\Temp/VBoxGuestAdditions.iso
<span class="kd">LogicalSectorSize</span> : <span class="m">2048</span>
<span class="kd">Number</span>            : <span class="m">0</span>
<span class="kd">Size</span>              : <span class="m">61538304</span>
<span class="kd">StorageType</span>       : <span class="m">1</span>
<span class="kd">PSComputerName</span>    :



<span class="kd">Mounting</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="kd">ISO</span> <span class="kd">to</span>: <span class="kd">D</span>
<span class="kd">Installing</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="m">6</span>.1.34 <span class="o">-</span> <span class="kd">guest</span> <span class="kd">version</span> <span class="kd">is</span> <span class="kd">unknown</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha1.cer'</span> <span class="kd">as</span> <span class="kd">trusted</span> <span class="kd">publisher</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha256.cer'</span> <span class="kd">as</span> <span class="kd">trusted</span> <span class="kd">publisher</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha1.cer'</span> <span class="kd">as</span> <span class="kd">root</span>
<span class="kd">VBoxCertUtil</span><span class="err">.exe</span>: <span class="kd">info</span>: <span class="kd">Successfully</span> <span class="kd">added</span> <span class="s1">'vbox-sha256.cer'</span> <span class="kd">as</span> <span class="kd">root</span>
<span class="kd">Unmounting</span> <span class="kd">Virtualbox</span> <span class="kd">Guest</span> <span class="kd">Additions</span> <span class="kd">ISO</span> <span class="kd">from</span>: <span class="kd">D</span>


<span class="kd">Attached</span>          : <span class="kd">False</span>
<span class="kd">BlockSize</span>         : <span class="m">0</span>
<span class="kd">DevicePath</span>        :
<span class="kd">FileSize</span>          : <span class="m">61538304</span>
<span class="kd">ImagePath</span>         : <span class="kd">C</span>:\Users\vagrant\AppData\Local\Temp/VBoxGuestAdditions.iso
<span class="kd">LogicalSectorSize</span> : <span class="m">2048</span>
<span class="kd">Number</span>            :
<span class="kd">Size</span>              : <span class="m">61538304</span>
<span class="kd">StorageType</span>       : <span class="m">1</span>
<span class="kd">PSComputerName</span>    :



<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Checking</span> <span class="k">for</span> <span class="kd">guest</span> <span class="kd">additions</span> <span class="k">in</span> <span class="kd">VM</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Setting</span> <span class="nb">hostname</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Configuring</span> <span class="kd">and</span> <span class="kd">enabling</span> <span class="kd">network</span> <span class="kd">interfaces</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Mounting</span> <span class="kd">shared</span> <span class="kd">folders</span>...
    <span class="kd">pc01</span>: <span class="na">/vagrant </span><span class="o">=&gt;</span> <span class="kd">D</span>:/Shared/Auror<span class="na">-Project/Vagrant
</span><span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
    <span class="kd">pc01</span>: <span class="kd">Running</span>: ./files/install<span class="na">-chrome</span>.ps1 <span class="kd">as</span> <span class="kd">C</span>:\tmp\vagrant<span class="na">-shell</span>.ps1
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">Still</span> <span class="kd">running</span>: <span class="kd">ChromeInstaller</span>
    <span class="kd">pc01</span>: <span class="kd">VERBOSE</span>: <span class="kd">Performing</span> <span class="kd">the</span> <span class="kd">operation</span> <span class="s2">"Remove File"</span> <span class="na">on</span> <span class="kd">target</span> <span class="s2">"C:\Users\vagrant\AppData\Local\Temp\ChromeInstaller.exe"</span>.
    <span class="kd">pc01</span>: <span class="kd">Ok</span>.
    <span class="kd">pc01</span>:
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
    <span class="kd">pc01</span>: <span class="kd">Running</span>: ./files/join<span class="na">-domain</span>.ps1 <span class="kd">as</span> <span class="kd">C</span>:\tmp\vagrant<span class="na">-shell</span>.ps1
    <span class="kd">pc01</span>: <span class="kd">Setting</span> <span class="kd">DNS</span> <span class="kd">server</span> <span class="kd">addresses</span>. . .
    <span class="kd">pc01</span>: <span class="kd">Joining</span> <span class="kd">Active</span> <span class="kd">Directory</span> <span class="kd">domain</span>. . .
    <span class="kd">pc01</span>: <span class="kd">WARNING</span>: <span class="kd">The</span> <span class="kd">changes</span> <span class="kd">will</span> <span class="kd">take</span> <span class="kd">effect</span> <span class="kd">after</span> <span class="kd">you</span> <span class="kd">restart</span> <span class="kd">the</span> <span class="kd">computer</span> <span class="kd">PC01</span>.
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
    <span class="kd">pc01</span>: <span class="kd">Running</span>: ./files/add<span class="na">-localadmin</span>.ps1 <span class="kd">as</span> <span class="kd">C</span>:\tmp\vagrant<span class="na">-shell</span>.ps1
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Running</span> <span class="kd">provisioner</span>: <span class="kd">shell</span>...
<span class="o">==&gt;</span> <span class="kd">pc01</span>: <span class="kd">Waiting</span> <span class="k">for</span> <span class="kd">machine</span> <span class="kd">to</span> <span class="kd">reboot</span>...
</pre></td></tr></tbody></table></code></pre></div></div>
:ET